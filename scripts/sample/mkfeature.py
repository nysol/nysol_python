#!/usr/bin/env python
# -*- coding: utf-8 -*-

import sys
import numpy as np
import nysol.util.margs as margs 
import nysol.mod as nm
from nysol.util._utillib import mcsvout as mcsvout
import nysol.util.mtemp as mtemp


data = """
no,id,time,F_x,F_y,F_z,T_x,T_y,T_z
0,1,0,-1,-1,63,-3,-1,0
1,1,1,0,0,62,-3,-1,0
2,1,2,-1,-1,61,-3,0,0
3,1,3,-1,-1,63,-2,-1,0
4,1,4,-1,-1,63,-3,-1,0
5,1,5,-1,-1,63,-3,-1,0
6,1,6,-1,-1,63,-3,0,0
7,1,7,-1,-1,63,-3,-1,0
8,1,8,-1,-1,63,-3,-1,0
9,1,9,-1,-1,61,-3,0,0
10,1,10,-1,-1,61,-3,0,0
11,1,11,-1,-1,64,-3,-1,0
12,1,12,-1,-1,64,-3,-1,0
13,1,13,-1,-1,60,-3,0,0
14,1,14,-1,0,64,-2,-1,0
15,2,0,-1,-1,63,-2,-1,0
16,2,1,-1,-1,63,-3,-1,0
17,2,2,-1,-1,61,-3,0,0
18,2,3,0,-4,63,1,0,0
19,2,4,0,-1,59,-2,0,-1
20,2,5,-3,3,57,-8,-3,-1
21,2,6,-1,3,70,-10,-2,-1
22,2,7,0,-3,61,0,0,0
23,2,8,0,-2,53,-1,-2,0
24,2,9,0,-3,66,1,4,0
25,2,10,-3,3,58,-10,-5,0
26,2,11,-1,-1,66,-4,-2,0
27,2,12,-1,-2,67,-3,-1,0
28,2,13,0,1,66,-6,-3,-1
29,2,14,-1,-1,59,-3,-4,0
30,3,0,-1,0,57,-5,-3,0
31,3,1,0,-3,63,-1,0,0
32,3,2,-1,1,51,-4,-1,-1
33,3,3,-1,-2,68,-2,-2,0
34,3,4,-1,-1,65,-6,1,0
35,3,5,0,0,61,-5,-2,0
36,3,6,-1,1,61,-6,0,-1
37,3,7,0,-3,57,3,-4,0
38,3,8,-1,-1,59,-4,-4,0
39,3,9,1,-3,65,-1,1,0
40,3,10,-1,2,64,-7,-2,0
41,3,11,-1,1,66,-7,-3,-1
42,3,12,-1,0,61,-5,-5,0
43,3,13,-1,0,65,-6,-2,-1
44,3,14,-1,0,54,-4,-3,0
45,4,0,0,-1,59,-2,-1,-1
46,4,1,0,-3,61,-1,2,0
47,4,2,-2,1,56,-6,-3,0
48,4,3,1,-3,64,-1,4,0
49,4,4,-1,1,62,-7,1,-1
50,4,5,-1,0,60,-9,-5,-1
51,4,6,1,1,56,-5,0,0
52,4,7,1,-1,66,-4,2,1
53,4,8,-2,5,64,-15,-2,0
54,4,9,-1,2,58,-8,-4,0
55,4,10,0,1,70,-9,-2,-1
56,4,11,-1,1,64,-8,-6,-1
57,4,12,0,-1,67,-6,0,-1
58,4,13,0,-2,63,-4,0,0
59,4,14,-1,1,63,-8,-2,0
60,5,0,0,-2,65,-4,-2,0
61,5,1,-1,-2,56,-5,-3,0
62,5,2,0,0,58,-9,-1,0
63,5,3,-1,-1,56,-5,-3,0
64,5,4,-2,3,57,-12,-4,-1
65,5,5,-1,-2,65,-5,-2,0
66,5,6,-1,2,56,-9,-5,0
67,5,7,2,-2,60,-2,3,1
68,5,8,0,1,67,-9,-2,1
69,5,9,-1,2,60,-10,-5,0
70,5,10,0,-3,63,-3,-1,0
71,5,11,-1,-1,73,-8,-5,0
72,5,12,-1,0,57,-7,-4,-1
73,5,13,-1,0,59,-8,-4,-1
74,5,14,-1,1,57,-9,-4,-1
75,6,0,-1,2,57,-10,-3,0
76,6,1,-2,3,60,-12,-4,-1
77,6,2,-1,2,63,-12,-6,1
78,6,3,1,3,62,-11,0,0
79,6,4,-3,2,56,-9,-4,0
80,6,5,0,1,58,-8,-1,-1
81,6,6,-1,3,57,-11,-4,0
82,6,7,-2,3,61,-10,-5,0
83,6,8,-3,3,60,-11,-4,0
84,6,9,1,2,64,-9,0,-1
85,6,10,-1,2,60,-9,-5,0
86,6,11,-1,3,63,-12,-6,0
87,6,12,-1,0,52,-8,-2,0
88,6,13,-2,3,58,-13,-5,0
89,6,14,1,-2,59,-7,0,-1
90,7,0,-3,1,53,-10,-4,0
91,7,1,0,-2,65,-4,-1,0
92,7,2,-1,-1,56,-7,-3,0
93,7,3,0,-2,60,-6,0,0
94,7,4,-1,-1,57,-7,-4,0
95,7,5,-1,-1,56,-7,-3,0
96,7,6,-1,-1,61,-8,-5,0
97,7,7,-1,0,57,-6,-5,0
98,7,8,-2,-1,57,-7,-4,1
99,7,9,-1,0,53,-10,-5,-1
100,7,10,0,-2,70,-7,-5,0
101,7,11,-1,0,67,-10,-7,-1
102,7,12,0,-2,50,-3,-1,0
103,7,13,-1,-1,59,-9,-4,0
104,7,14,0,-2,61,-6,-1,0
105,8,0,2,0,69,-10,2,1
106,8,1,-2,1,58,-11,-4,0
107,8,2,-2,3,54,-12,-6,0
108,8,3,1,-1,62,-6,0,0
109,8,4,-1,1,63,-11,-3,-1
110,8,5,-1,0,50,-8,-1,-1
111,8,6,-1,0,60,-13,-5,0
112,8,7,-1,0,57,-11,-4,-1
113,8,8,-1,0,60,-8,-5,-1
114,8,9,-1,1,60,-8,-5,-1
115,8,10,1,0,60,-7,-1,0
116,8,11,-2,1,60,-12,-6,3
117,8,12,-1,0,63,-10,-3,1
118,8,13,-1,-1,54,-11,-3,0
119,8,14,0,-3,57,-5,1,0
120,9,0,-1,1,58,-11,-4,-1
121,9,1,0,0,64,-9,-3,0
122,9,2,0,0,61,-11,-2,0
123,9,3,-1,2,55,-13,-3,1
124,9,4,-1,1,51,-11,-4,0
125,9,5,0,3,58,-13,-4,0
126,9,6,-3,5,61,-18,-7,-1
127,9,7,2,1,69,-10,0,1
128,9,8,-1,1,61,-13,-5,-1
129,9,9,-2,3,57,-15,-6,-1
130,9,10,0,-2,57,-8,-4,1
131,9,11,-1,-2,58,-8,-4,1
132,9,12,-1,-1,56,-10,-3,0
133,9,13,0,0,57,-9,-4,0
134,9,14,-1,0,57,-9,-4,3
135,10,0,-1,-1,63,-3,-1,0
136,10,1,-1,-1,61,-2,-2,0
137,10,2,-1,-1,63,-3,0,0
138,10,3,-1,-1,64,-2,0,0
139,10,4,-1,-1,63,-2,-1,0
140,10,5,-1,-1,63,-3,0,0
141,10,6,-1,-1,63,-2,-1,0
142,10,7,-1,-1,63,-3,0,0
143,10,8,-1,-1,63,-3,-1,0
144,10,9,-1,-1,63,-3,0,0
145,10,10,0,0,63,-3,-1,0
146,10,11,-1,-1,63,-2,-1,0
147,10,12,-1,-1,63,-2,-1,0
148,10,13,-1,-1,64,-2,0,0
149,10,14,-1,-1,64,-3,-1,0
150,11,0,-1,-1,63,-3,0,0
151,11,1,-1,-1,63,-3,0,0
152,11,2,-1,-1,63,-2,-1,0
153,11,3,-2,1,52,-6,-3,0
154,11,4,1,-7,68,6,2,0
155,11,5,-1,-1,63,-5,-1,0
156,11,6,0,2,64,-5,1,0
157,11,7,-3,4,57,-8,-3,0
158,11,8,0,-3,65,1,0,0
159,11,9,0,-3,61,-1,-1,0
160,11,10,-1,0,57,-5,-3,0
161,11,11,0,-3,70,0,1,0
162,11,12,-2,2,58,-8,-4,-1
163,11,13,-1,0,70,-5,-2,-1
164,11,14,-1,0,64,-5,0,-1
165,12,0,1,-3,62,-1,2,0
166,12,1,-1,0,51,-3,-2,-1
167,12,2,1,0,70,-5,1,-1
168,12,3,-1,0,63,-7,-2,-1
169,12,4,0,1,63,-6,-2,-1
170,12,5,1,-4,66,1,-1,0
171,12,6,2,1,66,-5,0,0
172,12,7,-3,2,59,-7,-4,0
173,12,8,-1,0,61,-4,-3,-1
174,12,9,-2,0,63,-5,-6,1
175,12,10,-1,-1,60,-3,-5,0
176,12,11,1,-4,59,0,1,0
177,12,12,-1,-3,51,-1,-4,0
178,12,13,0,-3,69,-3,1,0
179,12,14,-2,2,60,-10,-5,0
180,13,0,0,-1,69,-4,2,-1
181,13,1,-3,4,60,-12,-4,0
182,13,2,0,0,69,-5,-1,0
183,13,3,-1,3,67,-11,-2,1
184,13,4,-2,2,61,-9,-5,0
185,13,5,0,-5,59,0,-1,0
186,13,6,0,-5,60,0,1,0
187,13,7,-2,1,57,-6,-3,0
188,13,8,-2,2,61,-9,-5,-1
189,13,9,-1,3,68,-9,-4,0
190,13,10,-2,4,60,-10,-5,0
191,13,11,1,2,66,-10,1,-1
192,13,12,-1,-1,58,-5,2,0
193,13,13,1,-4,52,0,4,0
194,13,14,-1,-2,54,-3,-3,-1
195,14,0,1,-2,57,-4,0,-1
196,14,1,-1,0,64,-9,-2,0
197,14,2,-1,1,66,-8,-2,-1
198,14,3,-2,2,64,-11,-6,-1
199,14,4,0,1,60,-6,-1,-1
200,14,5,-1,-1,56,-6,-3,0
201,14,6,0,-1,59,-4,-5,-1
202,14,7,1,-2,64,-7,-2,-1
203,14,8,-2,1,59,-8,-6,0
204,14,9,1,-2,63,-4,-1,0
205,14,10,-1,-1,47,-3,-2,0
206,14,11,1,-4,59,0,2,0
207,14,12,-1,-3,64,-4,-6,0
208,14,13,0,-2,60,-4,-1,0
209,14,14,0,-1,60,-6,0,-1
210,15,0,-1,1,67,-9,-4,-1
211,15,1,1,-1,64,-5,-1,-1
212,15,2,1,-1,72,-6,-2,0
213,15,3,-1,1,58,-11,-4,-1
214,15,4,0,-3,58,-5,1,0
215,15,5,-1,2,58,-9,-4,0
216,15,6,-2,1,57,-9,-3,0
217,15,7,-1,-1,61,-5,0,0
218,15,8,0,1,61,-9,-1,-1
219,15,9,-2,4,54,-10,-4,0
220,15,10,-2,3,60,-11,-6,0
221,15,11,1,-1,69,-8,0,0
222,15,12,-3,2,58,-11,-5,1
223,15,13,-2,2,67,-11,-7,0
224,15,14,-1,0,65,-9,-3,-1
225,16,0,0,2,67,-11,-3,0
226,16,1,-1,0,56,-7,-3,-1
227,16,2,-1,1,65,-10,-6,-1
228,16,3,-1,3,63,-13,-6,0
229,16,4,-2,2,59,-8,-4,0
230,16,5,-1,-1,60,-5,-5,0
231,16,6,-2,2,61,-13,-5,0
232,16,7,0,1,56,-8,-3,-1
233,16,8,-1,1,56,-8,-3,0
234,16,9,-2,1,56,-10,-3,0
235,16,10,-1,0,59,-9,-4,0
236,16,11,-1,0,57,-9,-4,-1
237,16,12,-1,0,59,-11,-4,-1
238,16,13,-2,2,54,-10,-5,1
239,16,14,-3,2,50,-13,-6,-1
240,17,0,-1,1,58,-8,-4,1
241,17,1,-2,0,57,-7,-3,1
242,17,2,0,0,63,-11,-6,0
243,17,3,-2,-1,64,-9,-6,1
244,17,4,-2,0,54,-9,-5,1
245,17,5,-1,-1,57,-9,-4,0
246,17,6,-2,2,58,-10,-5,1
247,17,7,0,-3,63,-7,-1,0
248,17,8,-1,0,57,-8,-3,1
249,17,9,0,0,60,-10,-5,0
250,17,10,-1,1,56,-10,-3,0
251,17,11,0,0,55,-8,-3,2
252,17,12,-1,-1,50,-7,-2,-1
253,17,13,-1,-2,57,-6,-4,0
254,17,14,0,2,63,-12,-2,1
255,18,0,1,0,60,-8,1,1
256,18,1,-1,1,57,-12,-3,-1
257,18,2,-1,1,53,-12,-6,-1
258,18,3,-1,1,60,-11,-5,-1
259,18,4,-1,3,53,-12,-2,1
260,18,5,-1,1,57,-12,-5,-1
261,18,6,1,-2,68,-12,-2,-1
262,18,7,-1,-2,59,-8,-1,0
263,18,8,-2,3,56,-15,-6,0
264,18,9,1,-2,60,-6,2,0
265,18,10,0,1,60,-14,-5,0
266,18,11,-1,2,57,-13,-4,-2
267,18,12,-1,1,58,-11,-4,-1
268,18,13,-1,2,58,-12,-4,0
269,18,14,-1,2,57,-13,-4,0
270,19,0,24,53,79,-200,109,2
271,19,1,69,14,48,-40,100,0
272,19,2,15,-14,55,24,11,2
273,19,3,-9,-20,62,19,-16,2
274,19,4,11,-8,53,6,13,0
275,19,5,10,2,66,-6,13,0
276,19,6,-8,4,68,-10,-8,1
277,19,7,-12,5,58,-10,-18,1
278,19,8,1,6,59,-11,1,0
279,19,9,3,3,64,-9,4,0
280,19,10,-2,1,71,-6,-3,0
281,19,11,2,1,59,-6,3,0
282,19,12,1,2,63,-7,-1,0
283,19,13,-3,-1,61,-4,-5,-1
284,19,14,-3,-2,64,-3,-5,-1
285,20,0,185,105,118,-180,374,12
286,20,1,-10,5,75,-36,34,-2
287,20,2,-1,-4,43,1,-8,0
288,20,3,-10,-2,64,3,-19,0
289,20,4,0,-2,66,1,0,0
290,20,5,0,1,58,-5,2,-1
291,20,6,0,-5,61,2,-2,1
292,20,7,0,-4,57,1,-4,0
293,20,8,-1,-1,59,-1,-4,0
294,20,9,-1,1,64,-5,-6,1
295,20,10,0,0,67,-6,-3,0
296,20,11,-4,0,61,-5,-7,0
297,20,12,-3,1,60,-6,-4,0
298,20,13,-1,0,57,-4,-4,-1
299,20,14,1,1,65,-6,2,0
300,21,0,-21,-50,46,-180,266,98
301,21,1,-119,2,146,5,-115,-14
302,21,2,-38,-10,43,-8,-27,-4
303,21,3,3,9,66,-5,-3,-2
304,21,4,5,12,59,-16,11,1
305,21,5,-9,2,73,-2,-13,0
306,21,6,0,-4,51,5,-2,0
307,21,7,13,-3,66,3,18,0
308,21,8,8,-1,66,1,12,1
309,21,9,-5,0,54,-1,-7,0
310,21,10,-3,-1,63,1,-5,-1
311,21,11,-7,-2,65,3,-8,0
312,21,12,-1,-1,61,2,-1,0
313,21,13,-1,1,65,-2,-3,0
314,21,14,4,1,64,-2,7,1
315,22,0,112,-54,85,-77,284,-3
316,22,1,-5,-36,56,123,-115,-29
317,22,2,5,-24,74,50,-19,-2
318,22,3,7,-12,65,5,26,1
319,22,4,-2,-7,57,11,-3,0
320,22,5,-4,5,66,-7,-8,0
321,22,6,-2,4,57,-2,0,0
322,22,7,-4,4,65,-8,-6,0
323,22,8,-3,3,52,-3,-3,1
324,22,9,-2,3,57,-3,-1,0
325,22,10,1,1,64,1,2,1
326,22,11,1,1,60,-1,3,0
327,22,12,0,0,56,0,3,0
328,22,13,-1,2,63,-3,-1,-1
329,22,14,-1,4,59,-2,-1,1
330,23,0,95,-4,38,125,111,-4
331,23,1,17,9,43,-18,48,-4
332,23,2,-29,-6,55,6,-45,4
333,23,3,-8,11,68,-17,-8,6
334,23,4,9,13,61,-18,14,6
335,23,5,-10,6,68,-9,-15,0
336,23,6,-8,3,74,-4,-10,0
337,23,7,3,4,65,-8,6,1
338,23,8,8,4,61,-6,11,0
339,23,9,4,-1,59,1,5,0
340,23,10,-3,0,61,0,-5,-1
341,23,11,-2,0,67,0,-7,1
342,23,12,-3,3,59,-5,-4,0
343,23,13,-3,0,67,-2,-7,1
344,23,14,-3,3,64,-7,-6,1
345,24,0,-127,83,69,-71,-148,-53
346,24,1,-134,53,108,-59,-173,-23
347,24,2,-49,54,79,-75,-60,8
348,24,3,-15,53,74,-67,-8,1
349,24,4,-7,31,75,-40,-12,-10
350,24,5,-14,15,60,-15,-20,-6
351,24,6,-4,9,51,-15,-2,11
352,24,7,8,7,58,-11,12,2
353,24,8,6,-1,63,0,9,-6
354,24,9,-1,2,52,-5,-2,-5
355,24,10,-4,1,59,-6,-7,5
356,24,11,-1,1,52,-2,-2,2
357,24,12,3,0,66,-2,1,-4
358,24,13,1,1,60,-3,2,-2
359,24,14,0,1,64,-4,1,4
360,25,0,-72,-24,84,120,-196,-15
361,25,1,-26,-10,37,12,-50,-3
362,25,2,-30,-17,67,16,-40,-4
363,25,3,0,-3,50,-1,-10,0
364,25,4,0,-3,53,-2,-1,-3
365,25,5,-5,-1,60,-6,-11,-1
366,25,6,0,-3,64,-3,-4,-1
367,25,7,6,-4,57,-1,4,0
368,25,8,5,-5,59,-2,5,-1
369,25,9,-2,-4,64,-1,-7,0
370,25,10,-1,-3,58,-3,-5,0
371,25,11,0,0,60,-9,-3,0
372,25,12,1,-1,53,-4,-4,-2
373,25,13,0,0,59,-6,-3,0
374,25,14,1,1,59,-10,-2,0
375,26,0,-133,-34,18,21,131,-41
376,26,1,21,6,79,-36,59,-2
377,26,2,14,17,69,-45,13,-5
378,26,3,6,1,56,-5,7,7
379,26,4,15,-3,51,0,17,-2
380,26,5,10,-4,52,-2,8,-3
381,26,6,5,-6,63,2,3,1
382,26,7,0,-4,61,-1,-3,-2
383,26,8,-1,-1,61,-5,-6,-1
384,26,9,-1,1,61,-10,-6,-1
385,26,10,1,0,66,-10,-4,1
386,26,11,1,-3,59,-3,-2,0
387,26,12,-1,2,59,-12,-6,0
388,26,13,0,1,58,-9,-5,-1
389,26,14,0,0,60,-8,-6,-1
390,27,0,-10,-2,27,-17,8,3
391,27,1,22,-4,61,-6,28,1
392,27,2,22,4,62,-12,24,1
393,27,3,11,-5,55,-1,10,0
394,27,4,3,-13,61,10,-1,1
395,27,5,6,-8,57,5,4,0
396,27,6,8,-3,57,-1,9,1
397,27,7,0,-5,60,-1,-4,0
398,27,8,-5,-4,57,-4,-11,1
399,27,9,-4,-3,66,-2,-8,-1
400,27,10,1,0,59,-9,-6,-1
401,27,11,-3,6,64,-21,-17,-3
402,27,12,3,0,59,-8,-3,0
403,27,13,-2,0,60,-9,-7,1
404,27,14,-2,2,61,-12,-6,0
405,28,0,5,23,157,-186,179,2
406,28,1,-25,8,93,-46,25,-5
407,28,2,-16,-8,56,19,-54,1
408,28,3,1,-1,50,-5,-8,-1
409,28,4,0,2,55,-10,3,0
410,28,5,-5,-2,60,-4,-11,0
411,28,6,-1,-6,58,1,-5,0
412,28,7,5,-4,64,-4,2,-2
413,28,8,6,-5,63,-1,2,0
414,28,9,-1,-3,58,-2,-5,0
415,28,10,-1,-4,57,-2,-6,-2
416,28,11,0,-4,61,-4,-6,0
417,28,12,2,-5,66,-3,0,0
418,28,13,1,-2,53,-4,-4,-1
419,28,14,1,-3,51,-2,-3,0
420,29,0,-14,-10,52,15,-77,0
421,29,1,-22,-14,47,8,-31,2
422,29,2,-3,9,62,-23,-1,-1
423,29,3,0,8,59,-19,-1,-1
424,29,4,-10,4,60,-13,-16,0
425,29,5,-1,4,57,-13,-3,-2
426,29,6,2,6,66,-15,1,0
427,29,7,1,4,57,-12,2,0
428,29,8,-1,2,53,-8,-5,0
429,29,9,-3,-1,57,-5,-7,-1
430,29,10,0,1,68,-8,-2,-1
431,29,11,-1,2,57,-10,-6,-1
432,29,12,-1,0,67,-9,-6,0
433,29,13,1,1,61,-9,-3,-1
434,29,14,1,0,65,-9,-2,-1
435,30,0,8,-17,50,16,-1,-2
436,30,1,2,-25,55,22,-1,-1
437,30,2,10,-17,50,18,9,-2
438,30,3,3,-17,60,11,3,-2
439,30,4,7,-10,65,8,7,1
440,30,5,1,-9,56,1,-1,0
441,30,6,3,-12,59,10,3,-1
442,30,7,3,-5,58,-1,2,0
443,30,8,0,-8,63,2,-3,0
444,30,9,1,-2,56,-5,-1,0
445,30,10,-1,-2,56,-4,-5,-2
446,30,11,1,0,61,-7,-2,0
447,30,12,0,0,57,-8,-6,-1
448,30,13,-1,0,49,-9,-3,-1
449,30,14,-1,3,63,-11,-3,-1
450,31,0,3,-33,32,41,2,-1
451,31,1,9,-25,54,26,7,0
452,31,2,7,-12,44,-2,11,-1
453,31,3,3,-16,54,12,2,1
454,31,4,1,-17,56,12,1,1
455,31,5,2,-9,65,3,-2,-1
456,31,6,3,-5,53,-3,3,1
457,31,7,4,-7,56,-2,-1,-1
458,31,8,2,-9,49,3,2,0
459,31,9,2,-8,55,-1,-4,-2
460,31,10,2,-6,59,-3,-2,-1
461,31,11,2,-5,53,-3,-1,0
462,31,12,2,-3,46,-8,-3,0
463,31,13,1,-2,59,-4,-2,-1
464,31,14,0,-2,54,-11,-5,0
465,32,0,2,-3,70,-3,-1,0
466,32,1,0,7,69,-21,14,-15
467,32,2,-20,-7,52,9,-41,0
468,32,3,0,-2,63,-7,3,0
469,32,4,2,0,62,-6,2,-1
470,32,5,-3,0,57,-6,-5,-1
471,32,6,-2,-1,54,-4,-7,0
472,32,7,3,-5,54,0,3,-1
473,32,8,4,-3,63,-5,3,-1
474,32,9,1,-3,63,-3,0,0
475,32,10,-1,-3,59,-3,-7,-1
476,32,11,1,-3,60,-3,0,0
477,32,12,0,0,60,-8,-1,0
478,32,13,-1,0,57,-8,-6,-1
479,32,14,-1,1,58,-9,-3,0
480,33,0,4,-14,59,82,-85,13
481,33,1,32,7,47,-32,59,3
482,33,2,-2,2,72,-1,-16,1
483,33,3,-1,2,59,-15,-1,0
484,33,4,-1,3,58,-12,-2,1
485,33,5,1,3,67,-10,-4,1
486,33,6,-4,6,63,-15,-7,-1
487,33,7,-5,4,61,-14,-10,0
488,33,8,1,4,66,-14,-3,-1
489,33,9,2,2,65,-10,-1,-1
490,33,10,0,3,63,-13,0,-2
491,33,11,-2,5,57,-13,-6,-1
492,33,12,-1,1,65,-10,-4,0
493,33,13,-1,2,65,-11,-4,0
494,33,14,-1,0,59,-8,-7,0
495,34,0,71,51,5,686,494,-137
496,34,1,21,37,115,-85,55,-4
497,34,2,63,-9,6,-34,159,-10
498,34,3,13,-17,73,23,14,-2
499,34,4,0,-11,52,12,-13,0
500,34,5,8,-10,64,10,9,1
501,34,6,6,-4,57,-2,5,0
502,34,7,-3,-2,72,-7,-5,1
503,34,8,-8,1,53,-9,-15,-1
504,34,9,-1,6,74,-16,-4,-1
505,34,10,3,4,65,-11,1,0
506,34,11,1,3,62,-11,-1,-1
507,34,12,-1,0,60,-8,-7,0
508,34,13,-1,0,59,-8,-7,0
509,34,14,1,-2,65,-5,0,0
510,35,0,-93,76,80,-123,-151,-1
511,35,1,-20,63,62,-108,-30,-1
512,35,2,11,44,57,-64,15,-1
513,35,3,11,16,66,-27,7,0
514,35,4,0,0,58,-8,-4,0
515,35,5,3,-2,61,-7,-1,0
516,35,6,8,-3,63,-5,8,-1
517,35,7,7,1,59,-11,7,1
518,35,8,-3,0,59,-9,-9,-1
519,35,9,-6,2,57,-13,-13,-1
520,35,10,-2,4,74,-17,-7,0
521,35,11,3,6,59,-17,2,0
522,35,12,2,4,59,-14,1,-1
523,35,13,-1,2,61,-11,-3,-1
524,35,14,-2,1,64,-10,-6,0
525,36,0,-8,20,-5,-26,-10,-1
526,36,1,-10,22,-4,-22,-9,-2
527,36,2,-10,17,-4,-16,-10,-1
528,36,3,-9,15,0,-11,-6,0
529,36,4,-3,19,-21,12,21,-2
530,36,5,-38,130,-786,191,315,29
531,36,6,-30,139,-1235,472,601,39
532,36,7,-31,31,-39,-11,-3,3
533,36,8,-14,18,-21,24,22,8
534,36,9,-3,14,5,6,5,-4
535,36,10,-6,8,3,12,4,-1
536,36,11,-3,3,4,16,6,-2
537,36,12,0,5,10,17,6,-3
538,36,13,-3,5,10,14,2,-2
539,36,14,-3,3,10,16,4,-3
540,37,0,11,-3,-301,-267,-88,-16
541,37,1,28,-103,-826,-278,-237,6
542,37,2,46,-217,-1218,-147,-345,40
543,37,3,17,-95,-621,-164,-226,40
544,37,4,-6,10,-77,-103,-56,-6
545,37,5,-5,13,-104,-129,-60,-1
546,37,6,1,6,-112,-142,-66,-2
547,37,7,1,5,-111,-146,-58,-5
548,37,8,3,4,-113,-146,-54,-4
549,37,9,3,4,-115,-143,-58,-4
550,37,10,1,3,-116,-145,-61,-5
551,37,11,2,3,-119,-149,-62,-5
552,37,12,2,3,-118,-150,-60,-5
553,37,13,2,3,-117,-148,-58,-5
554,37,14,2,3,-118,-148,-58,-5
555,38,0,5,-4,-345,-185,0,0
556,38,1,-21,-59,-1162,-239,2,-5
557,38,2,-22,-106,-1360,-82,27,1
558,38,3,8,-46,100,52,-6,-9
559,38,4,1,-38,38,49,1,-1
560,38,5,13,-13,56,7,17,-2
561,38,6,3,-13,54,8,1,-1
562,38,7,1,-9,58,5,-1,-1
563,38,8,4,-5,60,-1,3,-1
564,38,9,2,-4,61,-3,1,-1
565,38,10,-2,-1,58,-7,-6,-2
566,38,11,-4,0,60,-8,-9,-1
567,38,12,-3,0,59,-9,-6,-1
568,38,13,-1,1,61,-8,-4,-1
569,38,14,1,0,60,-8,-2,-1
570,39,0,-6,15,-414,-53,16,-5
571,39,1,-38,14,-1357,-192,71,-9
572,39,2,4,-3,-90,-28,-20,12
573,39,3,11,-2,73,-4,22,-2
574,39,4,4,-4,42,-4,2,0
575,39,5,7,-17,61,13,6,0
576,39,6,7,-6,54,0,7,-1
577,39,7,1,-9,57,3,-1,-1
578,39,8,-2,-12,58,6,-6,-2
579,39,9,-1,-11,53,5,-5,-1
580,39,10,2,-11,58,4,-1,-1
581,39,11,3,-8,58,0,0,-2
582,39,12,1,-7,57,0,-2,-1
583,39,13,1,-4,57,-4,-2,-2
584,39,14,3,-3,58,-5,1,-2
585,40,0,-31,0,-398,-259,4,25
586,40,1,-80,-63,-987,-286,57,20
587,40,2,-88,-121,-1299,-229,137,1
588,40,3,20,40,-45,-54,24,-4
589,40,4,0,27,30,-51,-10,-5
590,40,5,-9,9,49,-27,-6,-2
591,40,6,-3,5,49,-25,-3,-2
592,40,7,2,3,46,-21,3,-2
593,40,8,1,-1,39,-19,3,-2
594,40,9,0,-2,38,-17,-1,0
595,40,10,1,-3,38,-18,2,-1
596,40,11,1,-3,38,-19,4,-1
597,40,12,0,-2,38,-19,0,0
598,40,13,-1,1,43,-18,-1,0
599,40,14,-1,2,46,-19,-2,-1
600,41,0,0,2,50,-13,-4,-1
601,41,1,0,0,58,-8,-3,-2
602,41,2,0,0,67,-11,-3,-1
603,41,3,0,-1,52,-7,-4,-1
604,41,4,0,0,56,-8,-6,-2
605,41,5,-1,1,64,-11,-5,-1
606,41,6,0,0,68,-9,-5,-1
607,41,7,-1,3,59,-16,-8,-1
608,41,8,0,0,68,-13,-4,-1
609,41,9,-1,1,59,-11,-3,-1
610,41,10,0,0,56,-11,-6,-2
611,41,11,-1,2,60,-13,-3,-2
612,41,12,0,3,61,-15,-3,-1
613,41,13,-1,3,63,-16,-8,-1
614,41,14,-1,2,64,-14,-5,-1
615,42,0,-20,55,-918,-90,-77,-6
616,42,1,-26,76,-1352,-127,-96,-9
617,42,2,4,9,54,-25,2,-4
618,42,3,-5,-7,62,0,-13,0
619,42,4,-5,12,53,-22,-9,-2
620,42,5,-7,6,57,-16,-13,-1
621,42,6,-3,3,58,-15,-7,-1
622,42,7,2,5,56,-18,0,-1
623,42,8,2,6,58,-17,-2,-1
624,42,9,0,6,57,-18,-3,-1
625,42,10,-2,3,57,-14,-6,-1
626,42,11,-1,2,57,-13,-6,-1
627,42,12,-1,1,54,-12,-5,-1
628,42,13,-1,1,56,-11,-6,-1
629,42,14,-2,0,57,-11,-6,-1
630,43,0,0,2,61,-12,-2,5
631,43,1,-1,0,60,-6,-3,0
632,43,2,-1,1,53,-8,-5,3
633,43,3,1,-2,66,-6,-2,-1
634,43,4,1,-1,60,-9,-3,-1
635,43,5,0,0,64,-9,-1,-1
636,43,6,0,0,57,-8,-4,-1
637,43,7,-1,1,64,-12,-4,-1
638,43,8,-1,1,66,-9,-4,-1
639,43,9,0,1,66,-13,-5,-1
640,43,10,-1,1,59,-12,-4,-1
641,43,11,-1,1,66,-12,-5,0
642,43,12,0,1,65,-12,-3,-2
643,43,13,1,1,63,-10,-2,-1
644,43,14,-1,0,64,-9,-5,-1
645,44,0,-35,17,-1029,-232,27,1
646,44,1,-45,31,-1395,-151,12,-11
647,44,2,10,-20,22,12,9,-1
648,44,3,-1,-24,62,20,-9,0
649,44,4,1,2,51,-13,-4,-2
650,44,5,-1,-4,59,-5,-7,0
651,44,6,1,1,56,-12,-4,-2
652,44,7,4,4,58,-15,3,-1
653,44,8,3,4,62,-16,0,-1
654,44,9,0,8,57,-19,-6,-1
655,44,10,-4,8,60,-20,-9,-1
656,44,11,-4,7,59,-18,-8,-1
657,44,12,-3,6,59,-17,-6,-1
658,44,13,-2,5,58,-17,-6,-1
659,44,14,-2,4,59,-16,-6,-1
660,45,0,1,0,57,8,5,7
661,45,1,-1,0,54,11,6,8
662,45,2,-11,38,-364,207,62,4
663,45,3,-77,175,-1133,383,-14,-25
664,45,4,-90,142,-1130,523,-21,-36
665,45,5,-37,59,-127,22,25,33
666,45,6,-2,6,-53,86,18,3
667,45,7,4,2,-17,53,38,10
668,45,8,3,1,-15,53,30,7
669,45,9,3,2,-23,56,33,10
670,45,10,4,5,-36,61,38,12
671,45,11,2,5,-36,60,37,10
672,45,12,3,4,-27,59,34,10
673,45,13,2,2,-20,58,33,9
674,45,14,3,2,-21,59,32,9
675,46,0,-6,27,-288,140,23,-2
676,46,1,-80,162,-1077,385,-38,-33
677,46,2,-102,158,-1264,543,-43,-43
678,46,3,64,-61,-95,142,91,15
679,46,4,-2,3,-67,93,45,22
680,46,5,7,6,-90,111,37,-1
681,46,6,5,6,-101,112,47,7
682,46,7,4,6,-108,116,49,8
683,46,8,2,3,-97,114,45,7
684,46,9,3,2,-93,110,45,7
685,46,10,4,2,-91,109,48,7
686,46,11,5,4,-97,109,52,10
687,46,12,5,5,-100,110,53,9
688,46,13,4,4,-99,108,53,10
689,46,14,5,5,-97,109,53,9
690,47,0,-13,-12,-558,-450,-108,21
691,47,1,-19,-69,-738,-430,-128,23
692,47,2,-20,-148,-923,-396,-156,36
693,47,3,-32,-176,-1168,-495,-210,52
694,47,4,-36,-192,-1286,-560,-232,55
695,47,5,27,-68,-588,-331,-39,17
696,47,6,-6,-72,-588,-378,-65,2
697,47,7,1,-35,-603,-403,-68,13
698,47,8,3,-48,-581,-381,-52,6
699,47,9,1,-46,-598,-397,-57,6
700,47,10,2,-49,-590,-390,-64,10
701,47,11,2,-46,-594,-393,-60,8
702,47,12,2,-47,-584,-387,-56,8
703,47,13,2,-45,-586,-386,-58,8
704,47,14,1,-45,-581,-383,-59,8
705,48,0,3,-10,-7,-44,1,5
706,48,1,-1,-86,-628,-338,-98,16
707,48,2,-35,-79,-685,-418,-206,46
708,48,3,-60,-113,-800,-453,-302,76
709,48,4,-78,-159,-1032,-535,-395,104
710,48,5,-92,-195,-1274,-672,-468,123
711,48,6,-66,-110,-614,-340,-284,83
712,48,7,27,-38,-640,-498,-38,3
713,48,8,4,-44,-654,-476,-88,9
714,48,9,11,-50,-606,-445,-70,3
715,48,10,13,-63,-598,-425,-63,2
716,48,11,11,-58,-601,-429,-64,3
717,48,12,10,-53,-595,-425,-63,3
718,48,13,10,-56,-599,-427,-65,3
719,48,14,10,-57,-599,-426,-67,4
720,49,0,-1,-86,-628,-338,-98,16
721,49,1,-35,-79,-685,-418,-206,46
722,49,2,-78,-159,-1032,-535,-395,104
723,49,3,-60,-113,-800,-453,-302,76
724,49,4,-92,-195,-1274,-672,-468,123
725,49,5,-66,-110,-614,-340,-284,83
726,49,6,27,-38,-640,-498,-38,3
727,49,7,4,-44,-654,-476,-88,9
728,49,8,11,-50,-606,-445,-70,3
729,49,9,13,-63,-598,-425,-63,2
730,49,10,11,-58,-601,-429,-64,3
731,49,11,10,-53,-595,-425,-63,3
732,49,12,10,-56,-599,-427,-65,3
733,49,13,10,-57,-599,-426,-67,4
734,49,14,11,-58,-601,-429,-64,3
735,50,0,-37,26,-779,-150,5,3
736,50,1,-51,23,-1340,-185,1,4
737,50,2,-7,31,0,-51,-16,-1
738,50,3,-7,32,52,-50,-12,-1
739,50,4,-2,21,58,-37,-4,0
740,50,5,-5,12,58,-26,-10,0
741,50,6,-3,8,57,-18,-8,0
742,50,7,-1,6,56,-18,-8,0
743,50,8,-1,6,56,-18,-8,0
744,50,9,0,4,58,-14,-4,0
745,50,10,0,0,59,-11,-3,0
746,50,11,1,1,59,-10,-2,0
747,50,12,0,0,58,-10,-2,0
748,50,13,-1,-1,58,-8,-5,0
749,50,14,-2,-1,54,-8,-7,0
750,51,0,-18,-9,46,-4,-11,-2
751,51,1,-6,-12,62,8,-16,2
752,51,2,35,20,-650,-97,-427,-13
753,51,3,68,47,-1145,-131,-633,-32
754,51,4,52,25,-877,-117,-530,-17
755,51,5,-16,6,0,5,-45,-4
756,51,6,-8,-16,72,11,-14,-1
757,51,7,-6,1,60,-12,-13,-1
758,51,8,-10,-3,58,-5,-16,-1
759,51,9,-8,-2,55,-7,-14,0
760,51,10,-5,-2,58,-5,-11,0
761,51,11,-2,-1,57,-7,-9,-1
762,51,12,1,2,53,-10,-7,0
763,51,13,-1,2,56,-11,-8,-1
764,51,14,-1,0,56,-10,-8,0
765,52,0,-21,1,-185,-202,3,11
766,52,1,-43,-86,-750,-315,127,10
767,52,2,-104,-105,-1173,-221,230,16
768,52,3,-134,-118,-1194,-183,195,15
769,52,4,-53,-5,-236,-273,26,9
770,52,5,-29,-9,-256,-267,12,-2
771,52,6,-17,1,-217,-245,27,3
772,52,7,-8,6,-210,-242,31,3
773,52,8,-9,6,-217,-253,34,4
774,52,9,-10,6,-225,-258,35,5
775,52,10,-7,6,-226,-259,38,4
776,52,11,-4,9,-217,-252,40,3
777,52,12,-4,8,-213,-249,39,4
778,52,13,-8,7,-216,-249,37,3
779,52,14,-8,7,-218,-252,35,3
780,53,0,-12,41,-133,-150,-53,-3
781,53,1,-10,40,-136,-145,-51,-3
782,53,2,-11,39,-142,-148,-54,-3
783,53,3,-12,43,-155,-158,-57,-3
784,53,4,-12,49,-169,-171,-58,-4
785,53,5,-14,51,-182,-175,-64,-4
786,53,6,-12,54,-195,-184,-60,-5
787,53,7,-15,54,-216,-188,-66,-4
788,53,8,-14,59,-235,-204,-66,-6
789,53,9,-14,62,-256,-213,-67,-5
790,53,10,-13,67,-278,-226,-67,-6
791,53,11,-15,68,-303,-233,-71,-6
792,53,12,-16,74,-328,-247,-75,-7
793,53,13,-15,77,-359,-259,-76,-7
794,53,14,-16,83,-394,-274,-79,-8
795,54,0,-17,99,-511,-319,-87,-10
796,54,1,-20,107,-554,-340,-91,-12
797,54,2,-19,113,-601,-357,-94,-12
798,54,3,-21,121,-657,-374,-99,-12
799,54,4,-19,127,-728,-391,-100,-14
800,54,5,-21,134,-800,-407,-105,-14
801,54,6,-21,137,-878,-419,-109,-15
802,54,7,-25,142,-966,-427,-118,-15
803,54,8,-24,145,-1083,-431,-115,-15
804,54,9,-25,151,-1180,-441,-124,-14
805,54,10,-24,134,-1287,-390,-121,-15
806,54,11,-25,127,-1409,-359,-124,-14
807,54,12,-25,123,-1491,-346,-127,-14
808,54,13,-31,141,-589,-360,-74,-16
809,54,14,-24,81,-481,-284,-148,-8
810,55,0,4,8,41,-28,10,0
811,55,1,4,7,33,-24,13,0
812,55,2,5,10,37,-31,14,0
813,55,3,4,8,27,-26,13,0
814,55,4,6,9,37,-30,15,0
815,55,5,6,11,29,-32,15,0
816,55,6,7,8,26,-28,18,0
817,55,7,6,10,23,-31,17,0
818,55,8,6,9,15,-28,17,1
819,55,9,8,11,24,-31,17,1
820,55,10,6,11,16,-32,17,1
821,55,11,7,12,12,-32,24,0
822,55,12,9,8,6,-28,22,1
823,55,13,8,11,7,-34,22,1
824,55,14,9,12,2,-32,23,0
825,56,0,6,9,15,-28,17,1
826,56,1,8,11,24,-31,17,1
827,56,2,6,11,16,-32,17,1
828,56,3,7,12,12,-32,24,0
829,56,4,9,8,6,-28,22,1
830,56,5,8,11,7,-34,22,1
831,56,6,9,13,0,-33,22,2
832,56,7,8,12,-8,-35,20,1
833,56,8,11,14,-21,-36,27,1
834,56,9,12,13,-13,-35,29,0
835,56,10,11,13,-16,-37,30,2
836,56,11,11,14,-24,-35,27,1
837,56,12,14,13,-26,-36,32,2
838,56,13,12,14,-31,-36,29,3
839,56,14,14,15,-35,-38,35,1
840,57,0,14,13,-26,-36,32,2
841,57,1,12,14,-31,-36,29,3
842,57,2,14,15,-35,-38,35,1
843,57,3,12,16,-52,-37,31,2
844,57,4,14,19,-52,-45,36,1
845,57,5,12,17,-63,-42,30,2
846,57,6,15,16,-64,-41,37,2
847,57,7,16,18,-83,-45,39,1
848,57,8,17,15,-91,-37,36,2
849,57,9,14,15,-99,-41,32,2
850,57,10,16,19,-113,-42,38,1
851,57,11,16,20,-132,-42,36,3
852,57,12,17,17,-139,-40,39,2
853,57,13,16,19,-160,-43,39,3
854,57,14,20,19,-174,-43,45,2
855,58,0,30,22,-325,-46,66,4
856,58,1,31,23,-368,-48,68,4
857,58,2,36,23,-415,-47,78,4
858,58,3,37,28,-476,-53,83,5
859,58,4,42,28,-540,-54,92,5
860,58,5,45,32,-606,-62,97,6
861,58,6,50,34,-702,-65,110,6
862,58,7,55,37,-812,-69,116,6
863,58,8,58,45,-924,-83,126,6
864,58,9,64,48,-1082,-89,141,6
865,58,10,70,54,-1251,-101,151,6
866,58,11,74,61,-1436,-109,156,6
867,58,12,74,61,-1437,-111,157,8
868,58,13,29,-24,-346,20,6,-2
869,58,14,19,-6,-380,32,25,1
870,59,0,0,1,70,-10,-2,-1
871,59,1,-1,1,60,-4,-1,0
872,59,2,1,1,53,-6,3,1
873,59,3,2,1,51,-2,8,1
874,59,4,2,2,57,-4,9,2
875,59,5,2,2,45,0,13,1
876,59,6,2,2,29,3,19,3
877,59,7,5,3,22,7,30,4
878,59,8,3,7,3,6,36,5
879,59,9,7,8,-4,14,50,8
880,59,10,7,9,-22,20,56,9
881,59,11,9,12,-34,24,72,10
882,59,12,13,13,-49,33,87,12
883,59,13,16,12,-69,49,107,13
884,59,14,16,11,-94,64,122,17
885,60,0,18,14,-113,74,140,12
886,60,1,20,11,-139,89,154,13
887,60,2,21,10,-157,99,165,16
888,60,3,19,15,-177,103,170,21
889,60,4,20,17,-192,105,178,22
890,60,5,13,21,-227,109,171,21
891,60,6,12,23,-234,108,170,20
892,60,7,5,27,-242,102,155,18
893,60,8,1,37,-243,76,144,18
894,60,9,-8,44,-280,70,131,16
895,60,10,-12,50,-304,65,132,16
896,60,11,-12,55,-325,64,137,17
897,60,12,-18,65,-359,57,138,16
898,60,13,-22,69,-399,66,138,16
899,60,14,-25,78,-429,60,144,17
900,61,0,-26,87,-454,51,150,18
901,61,1,-29,87,-475,61,150,19
902,61,2,-29,82,-476,76,150,18
903,61,3,-32,77,-498,107,150,16
904,61,4,-31,68,-515,153,163,13
905,61,5,-37,66,-589,198,166,13
906,61,6,-40,64,-637,238,178,12
907,61,7,-43,60,-669,273,186,9
908,61,8,-49,60,-727,299,188,7
909,61,9,-77,80,-807,305,153,0
910,61,10,-109,110,-968,318,141,-8
911,61,11,-141,139,-1107,336,118,-15
912,61,12,-184,177,-1241,311,77,-22
913,61,13,-226,212,-1371,312,19,-38
914,61,14,-260,236,-1501,327,2,-50
915,62,0,-254,219,-1428,308,-20,-51
916,62,1,-246,205,-1334,293,-48,-57
917,62,2,-247,203,-1302,291,-60,-61
918,62,3,-249,200,-1293,298,-70,-64
919,62,4,-251,195,-1286,279,-80,-62
920,62,5,-250,194,-1278,291,-85,-65
921,62,6,-249,192,-1266,290,-89,-67
922,62,7,-250,190,-1259,296,-95,-68
923,62,8,-248,190,-1252,295,-92,-68
924,62,9,-248,188,-1249,290,-93,-68
925,62,10,-248,185,-1248,277,-100,-64
926,62,11,-243,187,-1241,306,-112,-78
927,62,12,-249,181,-1238,276,-89,-59
928,62,13,-247,186,-1232,285,-83,-63
929,62,14,-241,183,-1227,307,-95,-71
930,63,0,0,0,50,-11,-7,0
931,63,1,1,-3,47,-9,-7,0
932,63,2,1,0,42,-15,-6,-1
933,63,3,-1,1,34,-18,-10,0
934,63,4,-1,-1,46,-13,-11,1
935,63,5,-1,-1,44,-14,-9,2
936,63,6,-3,-1,37,-13,-13,2
937,63,7,-5,-1,36,-17,-24,2
938,63,8,-4,-4,30,-14,-21,2
939,63,9,-2,-6,22,-14,-22,3
940,63,10,-5,-6,9,-20,-27,3
941,63,11,-5,-7,-2,-25,-33,4
942,63,12,-5,-4,-11,-39,-38,3
943,63,13,-9,-4,-14,-46,-48,2
944,63,14,-12,-2,-33,-55,-59,4
945,64,0,-14,-4,-51,-62,-70,6
946,64,1,-14,-9,-67,-62,-79,9
947,64,2,-16,-9,-84,-69,-87,9
948,64,3,-14,-8,-103,-83,-87,8
949,64,4,-11,-6,-124,-103,-84,6
950,64,5,-7,-6,-149,-122,-79,4
951,64,6,0,-8,-177,-134,-71,1
952,64,7,2,-9,-215,-152,-69,-1
953,64,8,5,-10,-260,-183,-78,-1
954,64,9,6,-10,-323,-220,-97,0
955,64,10,8,-12,-396,-261,-115,1
956,64,11,10,-11,-477,-306,-134,-1
957,64,12,13,-22,-605,-370,-171,-3
958,64,13,17,-49,-768,-396,-215,3
959,64,14,24,-127,-866,-259,-238,25
960,65,0,8,-12,-396,-261,-115,1
961,65,1,6,-10,-323,-220,-97,0
962,65,2,10,-11,-477,-306,-134,-1
963,65,3,17,-49,-768,-396,-215,3
964,65,4,13,-22,-605,-370,-171,-3
965,65,5,24,-127,-866,-259,-238,25
966,65,6,32,-183,-1053,-219,-290,43
967,65,7,37,-264,-1242,-126,-343,64
968,65,8,47,-343,-1407,-36,-385,86
969,65,9,45,-353,-1267,-6,-404,97
970,65,10,37,-10,-335,-335,-46,-18
971,65,11,8,7,-341,-296,-154,6
972,65,12,1,9,-338,-312,-128,-11
973,65,13,5,9,-341,-312,-109,-14
974,65,14,5,8,-343,-312,-117,-9
975,66,0,-1,-1,61,-5,-1,-1
976,66,1,-2,-1,58,-6,-4,0
977,66,2,6,4,-49,-57,-27,-2
978,66,3,14,13,-887,-220,-184,-14
979,66,4,20,-25,-1326,-166,-275,-4
980,66,5,-21,29,34,-61,-45,-3
981,66,6,3,-9,67,26,3,0
982,66,7,8,4,56,-11,10,-1
983,66,8,2,-2,59,-4,1,-1
984,66,9,-1,-4,54,-5,-3,-1
985,66,10,2,-2,58,-5,-2,-1
986,66,11,1,0,59,-7,-1,0
987,66,12,-1,1,61,-8,-4,0
988,66,13,-2,2,63,-8,-5,-1
989,66,14,-1,2,61,-9,-4,-1
990,67,0,-3,0,44,-11,-8,-2
991,67,1,0,-4,30,-5,-6,-2
992,67,2,-3,1,33,-15,-8,-2
993,67,3,-2,-1,23,-13,-9,-2
994,67,4,-3,0,15,-16,-14,-1
995,67,5,-2,0,-2,-19,-15,-2
996,67,6,-3,-1,-59,-27,-23,-2
997,67,7,-4,-2,-110,-33,-29,-2
998,67,8,-4,-3,-189,-46,-36,-3
999,67,9,-4,0,-297,-69,-39,-6
1000,67,10,-1,3,-457,-106,-44,-9
1001,67,11,0,7,-683,-144,-52,-14
1002,67,12,2,12,-991,-197,-70,-20
1003,67,13,0,6,-1368,-190,-80,-24
1004,67,14,-3,-10,-1547,-127,-70,-25
1005,68,0,-1,2,56,-11,-2,-1
1006,68,1,-1,0,58,-8,-6,0
1007,68,2,-4,1,57,-13,-8,-1
1008,68,3,-2,1,53,-12,-7,-1
1009,68,4,-2,1,51,-11,-6,-1
1010,68,5,-2,2,57,-14,-8,-1
1011,68,6,-2,0,58,-12,-8,-1
1012,68,7,-1,2,54,-14,-8,-1
1013,68,8,-2,3,57,-17,-8,0
1014,68,9,-2,5,53,-20,-7,-1
1015,68,10,-3,2,53,-16,-9,-1
1016,68,11,-2,2,52,-18,-9,-1
1017,68,12,-1,-1,54,-12,-8,0
1018,68,13,-2,1,56,-16,-8,-1
1019,68,14,-1,0,50,-16,-9,0
1020,69,0,-6,8,38,-45,-21,-1
1021,69,1,-5,7,41,-42,-20,1
1022,69,2,-5,7,40,-44,-22,-1
1023,69,3,-8,10,31,-50,-25,0
1024,69,4,-5,11,41,-55,-25,0
1025,69,5,-7,10,34,-56,-29,1
1026,69,6,-7,10,34,-58,-30,2
1027,69,7,-8,11,33,-64,-30,0
1028,69,8,-9,13,27,-65,-33,0
1029,69,9,-10,12,23,-66,-36,1
1030,69,10,-10,15,24,-71,-35,1
1031,69,11,-10,11,23,-70,-37,2
1032,69,12,-11,14,18,-79,-42,2
1033,69,13,-11,14,17,-83,-44,2
1034,69,14,-13,16,7,-87,-49,2
1035,70,0,-13,15,-2,-88,-51,3
1036,70,1,-14,17,0,-95,-54,4
1037,70,2,-16,19,-9,-103,-61,4
1038,70,3,-16,18,-9,-107,-64,6
1039,70,4,-18,19,-13,-112,-69,5
1040,70,5,-18,17,-20,-108,-67,6
1041,70,6,-20,20,-23,-122,-79,7
1042,70,7,-22,20,-28,-126,-85,3
1043,70,8,-24,22,-42,-138,-95,-2
1044,70,9,-25,21,-47,-145,-97,4
1045,70,10,-28,23,-57,-156,-108,9
1046,70,11,-32,30,-66,-173,-120,8
1047,70,12,-33,28,-76,-181,-125,13
1048,70,13,-35,29,-83,-190,-137,15
1049,70,14,-41,32,-101,-206,-152,18
1050,71,0,-59,44,-205,-305,-226,37
1051,71,1,-71,55,-273,-368,-271,42
1052,71,2,-75,58,-305,-403,-294,48
1053,71,3,-89,66,-408,-471,-342,51
1054,71,4,-95,64,-461,-503,-372,47
1055,71,5,-100,67,-524,-545,-400,51
1056,71,6,-104,55,-567,-547,-429,56
1057,71,7,-106,34,-626,-524,-440,62
1058,71,8,-112,33,-702,-567,-477,66
1059,71,9,-115,18,-774,-563,-502,73
1060,71,10,-115,-4,-848,-558,-527,81
1061,71,11,-116,-27,-929,-540,-543,86
1062,71,12,-115,-57,-1012,-516,-567,93
1063,71,13,-118,-78,-1113,-527,-600,101
1064,71,14,-119,-87,-1262,-599,-646,108
1065,72,0,-1,3,43,-21,-8,0
1066,72,1,0,4,46,-26,-6,-1
1067,72,2,3,2,38,-23,-4,-1
1068,72,3,2,3,39,-26,-4,0
1069,72,4,3,3,32,-22,-2,-1
1070,72,5,3,0,35,-21,-3,-1
1071,72,6,4,0,40,-23,-5,0
1072,72,7,4,3,29,-34,-9,-1
1073,72,8,4,4,27,-37,-11,-2
1074,72,9,1,6,25,-39,-16,0
1075,72,10,2,4,29,-43,-18,1
1076,72,11,1,4,22,-37,-19,1
1077,72,12,-3,4,26,-39,-26,1
1078,72,13,-2,3,19,-34,-25,2
1079,72,14,-2,1,19,-32,-26,3
1080,73,0,-2,1,13,-29,-25,3
1081,73,1,-2,1,17,-33,-28,2
1082,73,2,0,-1,12,-25,-19,2
1083,73,3,3,2,4,-45,-23,-1
1084,73,4,-1,1,13,-44,-30,2
1085,73,5,3,5,-2,-54,-25,-1
1086,73,6,6,1,-22,-64,-23,-3
1087,73,7,9,7,-37,-88,-26,-7
1088,73,8,13,9,-60,-113,-26,-14
1089,73,9,18,12,-95,-142,-27,-18
1090,73,10,22,14,-117,-172,-29,-24
1091,73,11,26,19,-152,-203,-31,-30
1092,73,12,35,17,-197,-238,-28,-35
1093,73,13,41,20,-248,-285,-31,-43
1094,73,14,53,19,-313,-337,-31,-53
1095,74,0,61,24,-386,-397,-30,-61
1096,74,1,65,32,-438,-467,-48,-69
1097,74,2,61,37,-411,-460,-47,-66
1098,74,3,58,39,-378,-438,-42,-64
1099,74,4,53,38,-364,-423,-42,-62
1100,74,5,53,38,-353,-416,-41,-61
1101,74,6,51,37,-348,-411,-43,-61
1102,74,7,50,37,-342,-407,-42,-60
1103,74,8,50,37,-336,-403,-42,-59
1104,74,9,49,36,-332,-401,-41,-58
1105,74,10,49,37,-331,-397,-42,-58
1106,74,11,49,37,-328,-395,-42,-58
1107,74,12,48,36,-325,-393,-41,-57
1108,74,13,48,36,-324,-391,-41,-57
1109,74,14,48,36,-322,-389,-42,-56
1110,75,0,-2,1,38,-22,-13,3
1111,75,1,-1,0,43,-21,-13,5
1112,75,2,-2,-2,37,-18,-17,5
1113,75,3,-4,-3,30,-16,-23,6
1114,75,4,-3,-5,22,-13,-22,7
1115,75,5,-2,-8,17,-7,-23,6
1116,75,6,4,-13,10,-8,-12,3
1117,75,7,4,-12,4,-10,-12,3
1118,75,8,5,-15,3,-6,-8,3
1119,75,9,5,-12,5,-11,-10,3
1120,75,10,6,-12,5,-12,-9,2
1121,75,11,4,-10,6,-13,-12,2
1122,75,12,6,-10,4,-13,-9,3
1123,75,13,6,-9,4,-17,-8,3
1124,75,14,6,-4,-14,-52,-20,0
1125,76,0,8,4,-48,-86,-23,-5
1126,76,1,13,7,-76,-114,-26,-11
1127,76,2,18,9,-95,-140,-29,-16
1128,76,3,19,17,-124,-189,-44,-21
1129,76,4,16,19,-117,-183,-46,-19
1130,76,5,13,17,-107,-176,-46,-17
1131,76,6,12,15,-103,-172,-47,-13
1132,76,7,12,17,-98,-167,-47,-14
1133,76,8,11,16,-97,-165,-47,-16
1134,76,9,11,16,-95,-163,-47,-15
1135,76,10,10,16,-94,-161,-47,-15
1136,76,11,10,16,-91,-160,-47,-14
1137,76,12,10,17,-90,-159,-47,-14
1138,76,13,10,16,-89,-158,-47,-14
1139,76,14,9,16,-88,-157,-47,-14
1140,77,0,-1,3,46,-3,-2,1
1141,77,1,-4,3,37,0,-2,1
1142,77,2,-2,4,37,0,2,2
1143,77,3,-3,2,26,7,-3,1
1144,77,4,-4,2,23,6,-5,0
1145,77,5,-5,3,26,5,-6,0
1146,77,6,-4,2,24,5,-6,1
1147,77,7,-6,5,22,6,-6,-1
1148,77,8,-5,5,17,9,-2,0
1149,77,9,-6,8,8,2,-2,1
1150,77,10,-5,7,11,6,0,0
1151,77,11,-6,7,1,1,-2,1
1152,77,12,-7,9,9,3,-2,1
1153,77,13,0,4,6,24,14,0
1154,77,14,-3,6,-12,18,15,1
1155,78,0,-2,10,-31,21,29,5
1156,78,1,-1,17,-54,23,46,8
1157,78,2,2,24,-78,24,60,8
1158,78,3,-1,31,-112,24,70,14
1159,78,4,-3,43,-146,15,79,20
1160,78,5,-1,49,-172,20,92,23
1161,78,6,-5,56,-214,31,100,23
1162,78,7,-12,60,-254,52,104,18
1163,78,8,-15,68,-291,63,110,23
1164,78,9,-15,76,-345,75,126,25
1165,78,10,-13,81,-404,105,161,25
1166,78,11,-13,88,-472,137,194,29
1167,78,12,-11,91,-532,173,225,34
1168,78,13,-7,89,-553,196,245,38
1169,78,14,-3,81,-508,186,234,35
1170,79,0,-2,77,-487,179,227,36
1171,79,1,-2,74,-472,177,221,34
1172,79,2,-2,73,-462,175,218,32
1173,79,3,-3,71,-456,173,213,32
1174,79,4,-3,70,-451,173,212,31
1175,79,5,-3,69,-444,171,209,31
1176,79,6,-2,68,-441,171,207,31
1177,79,7,-2,67,-437,170,205,30
1178,79,8,-2,67,-434,170,203,30
1179,79,9,-2,66,-431,169,202,29
1180,79,10,-2,65,-429,169,202,29
1181,79,11,-2,65,-426,168,200,28
1182,79,12,-2,64,-424,168,199,29
1183,79,13,-2,64,-421,168,199,29
1184,79,14,-2,64,-420,167,198,29
1185,80,0,-5,-2,48,7,-9,-1
1186,80,1,-5,0,36,7,-9,-1
1187,80,2,-4,-2,44,13,-9,-1
1188,80,3,-4,-2,38,14,-9,-3
1189,80,4,-5,0,32,12,-8,-1
1190,80,5,-6,1,27,13,-10,0
1191,80,6,-6,3,23,9,-11,-2
1192,80,7,-5,1,24,10,-10,-2
1193,80,8,-5,3,25,8,-9,0
1194,80,9,-6,4,24,6,-9,0
1195,80,10,0,1,24,11,0,-2
1196,80,11,-2,4,11,8,2,2
1197,80,12,-6,10,7,-1,-1,1
1198,80,13,-4,7,13,9,3,2
1199,80,14,-2,7,11,6,2,2
1200,81,0,-4,7,10,5,0,1
1201,81,1,-1,8,10,4,4,2
1202,81,2,-6,9,-11,26,3,0
1203,81,3,-7,12,-39,34,4,-1
1204,81,4,-6,14,-65,49,10,0
1205,81,5,-8,21,-100,52,15,0
1206,81,6,-6,26,-119,61,25,3
1207,81,7,-7,35,-169,77,43,6
1208,81,8,-3,48,-239,102,70,9
1209,81,9,4,57,-301,139,102,16
1210,81,10,0,52,-296,139,95,12
1211,81,11,1,48,-276,133,94,13
1212,81,12,2,47,-264,129,94,14
1213,81,13,3,45,-257,125,92,15
1214,81,14,4,44,-252,123,94,15
1215,82,0,-3,0,46,0,-5,1
1216,82,1,-2,0,58,3,-5,0
1217,82,2,0,-5,53,10,0,0
1218,82,3,-2,-1,49,7,-6,0
1219,82,4,-1,-5,47,14,0,-1
1220,82,5,0,-6,50,22,1,0
1221,82,6,-1,-6,43,23,3,-1
1222,82,7,-4,-4,33,21,-1,-1
1223,82,8,-2,-8,39,34,3,-2
1224,82,9,-2,-6,26,35,5,-2
1225,82,10,-4,-6,22,36,2,-2
1226,82,11,-4,-7,10,42,3,-3
1227,82,12,-6,-9,6,50,-4,-5
1228,82,13,-10,-8,8,54,-12,-7
1229,82,14,-8,-9,4,58,-11,-7
1230,83,0,-15,-9,-26,70,-22,-11
1231,83,1,-15,-8,-27,74,-20,-11
1232,83,2,-14,-9,-26,76,-23,-12
1233,83,3,-16,-10,-29,74,-22,-10
1234,83,4,-14,-9,-24,80,-19,-11
1235,83,5,-15,-10,-33,84,-15,-10
1236,83,6,-14,-12,-43,93,-11,-11
1237,83,7,-15,-12,-53,99,-10,-11
1238,83,8,-16,-9,-71,96,-8,-12
1239,83,9,-20,-9,-88,106,-8,-14
1240,83,10,-24,-9,-90,111,-21,-15
1241,83,11,-27,-12,-114,131,-20,-16
1242,83,12,-26,-15,-138,151,-14,-16
1243,83,13,-26,-15,-160,162,-4,-15
1244,83,14,-28,-13,-181,172,1,-14
1245,84,0,-29,-10,-208,180,12,-11
1246,84,1,-29,-4,-246,192,24,-10
1247,84,2,-26,-3,-300,220,55,-6
1248,84,3,-25,2,-386,255,92,-2
1249,84,4,-25,7,-486,297,130,0
1250,84,5,-35,16,-644,363,167,-1
1251,84,6,-69,49,-783,357,135,-11
1252,84,7,-98,73,-961,400,124,-21
1253,84,8,-110,83,-1018,410,118,-21
1254,84,9,-107,76,-986,408,112,-25
1255,84,10,-105,71,-957,404,112,-26
1256,84,11,-102,67,-939,407,100,-28
1257,84,12,-104,66,-927,400,107,-22
1258,84,13,-104,64,-918,396,101,-23
1259,84,14,-105,63,-912,394,100,-25
1260,85,0,4,6,50,-25,1,0
1261,85,1,4,8,44,-26,2,-1
1262,85,2,5,8,41,-29,3,-2
1263,85,3,6,8,39,-26,2,-2
1264,85,4,7,8,39,-29,4,-2
1265,85,5,7,8,32,-32,4,-2
1266,85,6,8,7,37,-30,1,-2
1267,85,7,6,9,32,-33,1,-2
1268,85,8,8,11,26,-38,-1,-4
1269,85,9,12,9,31,-37,4,-5
1270,85,10,13,7,25,-36,7,-5
1271,85,11,13,13,9,-41,8,-5
1272,85,12,14,14,12,-41,5,-6
1273,85,13,17,15,4,-46,14,-7
1274,85,14,19,14,2,-42,10,-7
1275,86,0,21,15,-14,-46,16,-7
1276,86,1,23,18,-27,-49,14,-10
1277,86,2,28,16,-26,-47,25,-9
1278,86,3,31,20,-42,-55,25,-8
1279,86,4,35,21,-55,-55,33,-10
1280,86,5,39,26,-68,-60,35,-10
1281,86,6,45,27,-83,-63,45,-9
1282,86,7,52,31,-110,-66,51,-9
1283,86,8,60,31,-135,-65,64,-8
1284,86,9,70,36,-163,-69,77,-8
1285,86,10,81,39,-199,-71,93,-4
1286,86,11,94,47,-243,-78,112,-2
1287,86,12,109,52,-294,-80,134,1
1288,86,13,125,60,-346,-88,154,4
1289,86,14,148,69,-411,-95,191,8
1290,87,0,171,86,-486,-113,222,13
1291,87,1,198,96,-566,-125,261,15
1292,87,2,222,112,-667,-136,290,20
1293,87,3,253,126,-780,-142,327,22
1294,87,4,287,142,-930,-138,362,27
1295,87,5,324,158,-1108,-133,389,29
1296,87,6,338,162,-1145,-125,419,32
1297,87,7,340,160,-1104,-124,433,35
1298,87,8,339,158,-1077,-126,437,37
1299,87,9,338,155,-1074,-122,462,39
1300,87,10,336,154,-1051,-127,454,37
1301,87,11,340,151,-1041,-140,458,39
1302,87,12,339,154,-1036,-134,471,42
1303,87,13,342,154,-1036,-118,466,44
1304,87,14,342,154,-1036,-118,466,44
1305,88,0,-6,3,52,-15,-17,3
1306,88,1,-7,2,52,-17,-20,3
1307,88,2,-9,5,46,-21,-22,4
1308,88,3,-8,1,53,-15,-20,5
1309,88,4,-8,2,43,-16,-20,5
1310,88,5,-8,2,46,-17,-22,5
1311,88,6,-8,0,46,-16,-21,5
1312,88,7,-9,2,39,-20,-22,5
1313,88,8,-11,3,42,-22,-27,6
1314,88,9,-10,4,40,-22,-23,5
1315,88,10,-10,2,39,-21,-24,5
1316,88,11,-11,2,38,-24,-22,6
1317,88,12,-12,3,23,-24,-24,5
1318,88,13,-13,4,26,-29,-27,5
1319,88,14,-13,2,15,-25,-25,6
"""

# サンプルデータ出力
temo = mtemp.Mtemp()
sampleData = temo.file()
with open(sampleData,"w") as wfp:
	wfp.write(data.strip())


# データ生成
inf = sampleData
orgid = ["id"]
sflds = ["time%n"]
fld = ["F_x","F_y","F_z","T_x","T_y","T_z"]
outf = "featureAll.csv"




rlsDIR = temo.file()
#rlsDIR = "./tmpresult"

baseDATA = temo.file()
sumDATA =  temo.file()
div2DATA = temo.file()

mapDATA  = rlsDIR+"/idmap.csv"

import os
if rlsDIR and not os.path.isdir(rlsDIR) :
	os.makedirs(rlsDIR)


#idとtimeは番号をつけ直す
#fld項目名変更 
sbase_flds=[]
for x in sflds:
	xx=x.split("%")
	sbase_flds.append(xx[0])



keyfld = ["__keyID","fldkey"]
seqfld = ["__seq%n"]
seqfldB = ["__seq"]
keySize = len(keyfld)

base0 = nm.mcut(f=list(set(orgid+sbase_flds+fld)),i=inf)
base0 <<= nm.mnumber(k=orgid,a="__keyID",B=True)
base0 <<= nm.mnumber(k=orgid,s=sflds,a="__seq")

base1 = nm.m2cross(k="__keyID,__seq",f=fld,a="fldkey,val",i=base0)
base1 <<= nm.msortf(f="__keyID,fldkey,__seq%n")
base1 <<= nm.mcut(f=keyfld+seqfldB+["val"],o=baseDATA)

base2 = nm.muniq(k="__keyID",i=base0)
base2 <<= nm.mcut(f=["__keyID"]+orgid,o=mapDATA)

nm.runs([base1,base2])


#平均と分散
calfld = "mean,var,count,sd,ukurt,max,min,median,uvar,uskew,sum"
nm.msummary(k=keyfld,f="val",c=calfld,i=baseDATA,o=sumDATA).run()

nm.m2cross(i=sumDATA,k=keyfld,f=calfld,a="way,val",o=rlsDIR+"/rls0.csv").run()

#dict TEST
for ddict in nm.readcsv(baseDATA).keyblock_dict(keyfld,seqfld):
	print(ddict)

#baseDATAが元になるデータ
#sumDATAがsummaryデータ

#abs_energy,absolute_sum_of_changes,abs_energy
f1 =   nm.mcal(c="${val}*${val}",a="abs_energy", i=baseDATA)
f1 <<= nm.msortf(f=keyfld+seqfld)
f1 <<= nm.mcal(c="abs(${val}-#{val})",a="absolute_sum_of_changes")
f1 <<= nm.msum(k=keyfld,f="absolute_sum_of_changes,abs_energy",o=div2DATA)
f1.run()

nm.m2cross(i=div2DATA,k=keyfld,a="way,val",f="absolute_sum_of_changes,abs_energy",o=rlsDIR+"/rls1.csv").run()

#autocorrelation agg ここはもっといい方法ありそう
f2 =   nm.mcut(f=keyfld+seqfldB,i=baseDATA)
f2 <<= nm.mjoin(k=keyfld,m=sumDATA,f="mean,var,count") 
f2 <<= nm.mcombi(k=keyfld, f=seqfldB ,a="t1,t2",n=2)
f2 <<= nm.mfsort(f="t1,t2",n=True)
f2 <<= nm.mcal(c="${t2}-${t1}",a="rag")
f2 <<= nm.mjoin(k=keyfld+["t1"], m=baseDATA, K=keyfld+seqfldB,f="val:val_t1")
f2 <<= nm.mjoin(k=keyfld+["t2"], m=baseDATA, K=keyfld+seqfldB,f="val:val_t2")
f2 <<= nm.mcal(c='(${val_t1}-${mean})*(${val_t2}-${mean})',a="sub_t1t2") 
f2 <<= nm.msum(k=keyfld+["rag"],f="sub_t1t2") 
f2 <<= nm.mcal(c="${sub_t1t2}/(${count}-${rag})/${var}",a="t1t2sum")
f2 <<= nm.msummary(k=keyfld,c="mean:autocorrelation_agg_mean,median:autocorrelation_agg_median,var:autocorrelation_agg_var",f="t1t2sum")
f2 <<= nm.m2cross(k=keyfld,a="way,val",f="autocorrelation_agg_mean,autocorrelation_agg_median,autocorrelation_agg_var",o=rlsDIR+"/rls2.csv")
f2.run()

#linregress chunk(5,10,50)

f3 = nm.mcal(c='int(${__seq}/5),int(${__seq}/10),int(${__seq}/50)',i=baseDATA,a="cs5,cs10,cs50")
funcList3 = []
for lg in [5,10,50]:

	f3_0 = nm.msummary(k=keyfld+["cs%d"%(lg)],i=f3,f="val",c="max,min,mean,median")
	
	f3_1 = nm.mcount(k=keyfld,i=f3_0,a="cnt")
	f3_1 <<= nm.mcal(c='${cnt}-2',a="df")
		
	f3_2 = nm.mnumber(k=keyfld,q=True,a="x",i=f3_0)

	f3_3 = nm.msummary(i=f3_2,k=keyfld,c="var,mean",f="x,max,min,mean,median")
	f3_3 <<= nm.msortf(f=keyfld+["fld"])

	f3_4 = nm.msim(i=f3_2,k=keyfld,f="x,max,min,mean,median",c="covar")
	f3_4 <<= nm.mselstr(f="fld1,fld2",v="x")
	f3_4 <<= nm.mjoin(k=keyfld+["fld1"],K=keyfld+["fld"],f="var:var1,mean:mean1",m=f3_3)
	f3_4 <<= nm.mjoin(k=keyfld+["fld2"],K=keyfld+["fld"],f="var:var2,mean:mean2",m=f3_3)
	f3_4 <<= nm.mjoin(k=keyfld,f="df",m=f3_1)
	f3_4 <<= nm.mcal(c="sqrt(${var1}*${var2})",a="mm")
	f3_4 <<= nm.mcal(c="if(${mm}==0,0,${covar}/${mm})",a="rvalue")
	f3_4 <<= nm.mcal(c="${rvalue}*sqrt(${df}/((1-${rvalue})*(1+${rvalue})))",a="t")
	f3_4 <<= nm.mcal(c="${covar}/${var1}",a="slope")
	f3_4 <<= nm.mcal(c="${mean2}-${slope}/${mean1}",a="intercept")
	f3_4 <<= nm.mcal(c="sqrt((1-${rvalue}^2)*${var2}/${var1}/${df})",a="stderr")
	f3_4 <<= nm.mcut(f=keyfld+["fld2","intercept","rvalue","slope","stderr"])
	f3_4 <<= nm.msetstr(a="len",v=lg)
	f3_4 <<= nm.m2cross(k=keyfld+["fld2","len"],f=["intercept","rvalue","slope","stderr"],a="k,val")
	f3_4 <<= nm.mcal(a="way",c='"agg_linear_trend_agg_"+$s{fld2}+"_chunk_len_"+$s{len}+"_attr_"+$s{k}' )
	#f3_4 <<= nm.mcal(a="way",c="'agg_linear_trend_agg_'+$s{fld2}+'_chunk_len_'+$s{len}+'_attr_'+$s{k}" )
	#　上はだめ 
	f3_4 <<= nm.mcut(f=keyfld+["way","val"],o=rlsDIR+"/rls3_%d.csv"%(lg))
	funcList3.append(f3_4)

nm.runs(funcList3)

#approximate_entropy
mval =2
rvals =[0.1,0.3,0.5,0.7,0.9]
#rvals =[0.1]
# m
fpara1_0 = ",".join([ "val%d:val%d_t"%(i,i) for i in range(mval)])
fpara1_1c = "max(%s)"%(",".join(["abs(${val%d}-${val%d_t})"%(i,i) for i in range(mval)]))

f4_1 =   nm.mslide(k=keyfld,s=seqfld,f="val",t=mval-1,i=baseDATA)
f4_1 <<= nm.mfldname(f="val:val0")
f4_1 <<= nm.mjoin(k=keyfld,f="sd,count",m=sumDATA)

f4_2 =   nm.mnjoin(k=keyfld,i=f4_1,m=f4_1,f=fpara1_0)
f4_2 <<= nm.mcal(c=fpara1_1c,a="val_max")

# m+1
pfpara1_0 = ",".join([ "val%d:val%s_t"%(i,i) for i in range(mval+1)])
pfpara1_1c = "max(%s)"%(",".join([ "abs(${val%d}-${val%d_t})"%(i,i) for i in range(mval+1)]))

pf4_1 =   nm.mslide(k=keyfld,s=seqfld,f="val",t=mval,i=baseDATA)
pf4_1 <<= nm.mfldname(f="val:val0")
pf4_1 <<= nm.mjoin(k=keyfld,f="sd,count",m=sumDATA)

pf4_2 =   nm.mnjoin(k=keyfld,i=pf4_1,m=pf4_1,f=pfpara1_0)
pf4_2 <<= nm.mcal(c=pfpara1_1c,a="val_max")

funcList4 = []

for rval in rvals:
	f4_3 =   nm.msetstr(a="r",v=rval,i=f4_2) 
	f4_3 <<= nm.mcal(c="${val_max}<=${r}*${sd}",a="match") 
	#ここら辺 msimでもOK?
	f4_3 <<= nm.msum(k=keyfld+seqfldB,f="match") 
	f4_3 <<= nm.mcal(c="${match}/(${count}-%d+1)"%(mval),a="C") 
	f4_3 <<= nm.mcal(c="ln(${C})",a="Clog") 
	f4_3 <<= nm.msum(k=keyfld,f="Clog") 
	f4_3 <<= nm.mcal(c="${Clog}/(${count}-%d+1)"%(mval),a="phi0") 

	f4_4 =   nm.msetstr(a="r",v=rval,i=pf4_2) 
	f4_4 <<= nm.mcal(c="${val_max}<=(${r}*${sd})",a="match") 
	f4_4 <<= nm.msum(k=keyfld+seqfldB,f="match") 
	f4_4 <<= nm.mcal(c="${match}/(${count}-%d+1)"%(mval+1),a="C") 
	f4_4 <<= nm.mcal(c="ln(${C})",a="pClog") 
	f4_4 <<= nm.msum(k=keyfld,f="pClog") 
	f4_4 <<= nm.mcal(c="${pClog}/(${count}-%d+1)"%(mval+1),a="phi1") 

	f4_5 =   nm.mjoin(i=f4_3,m=f4_4,k=keyfld,f="phi1")
	f4_5 <<= nm.mcal(c="abs(${phi0}-${phi1})",a="approximate_entropy")
	f4_5 <<= nm.msetstr(a="m",v=mval)
	f4_5 <<= nm.mcal(a="way",c='"approximate_entropy_m_"+$s{m}+"_r_"+$s{r}')
	f4_5 <<= nm.m2cross(k=keyfld+["way"],f="approximate_entropy",a="k,val")
	f4_5 <<= nm.mcut(f=keyfld+["way","val"],o=rlsDIR+"/rls4_%g.csv"%(rval))
	funcList4.append(f4_5)

nm.runs(funcList4)

from statsmodels.tsa.ar_model import AR
#ar_coefficient
k_s=[10]
coeff_s=[1,2,3,4]

headL = keyfld[:]
for k in k_s:
	for coeff in coeff_s:
		headL.append("ar_coefficient_k_{}__coeff_{}".format(k, coeff))


rlsf_1 = temo.file()

with mcsvout(rlsf_1,f=headL) as rf1:

	for dlist in nm.readcsv(baseDATA).keyblock(keyfld,seqfld):
		calculated_ar_params = {}
		calculated_AR = AR([float(xdlist[keySize+1]) for xdlist in dlist])

		rls =dlist[0][0:keySize]
		for k in k_s:
			for coeff in coeff_s:
				#以下
				#/tsfresh/feature_extraction/feature_calculators.pyより
				if k not in calculated_ar_params:
					try:
						calculated_ar_params[k] = calculated_AR.fit(maxlag=k, solver="mle").params
					except:
						calculated_ar_params[k] = [np.NaN]*k

				mod = calculated_ar_params[k]
				if coeff <= k:
					try:
						rls.append("{}".format(mod[coeff]))
					except IndexError:
						rls.append("0")
				else:
					rls.append("{}".format(np.NaN)) 
		

		rf1.write(rls) 


nm.m2cross(i=rlsf_1,k=keyfld,f="ar_coefficient_k_*",a="way,val",o=rlsDIR+"/rlsf_1.csv").run()

#augmented_dickey_fuller
from statsmodels.tsa.stattools import adfuller
head = keyfld + ["way","val"]

with mcsvout(rlsDIR+'/rlsf_2.csv',f=head) as rf2:

	for dlist in nm.readcsv(baseDATA).keyblock(keyfld,seqfld):
		id =dlist[0][0:keySize]
		#以下
		#/tsfresh/feature_extraction/feature_calculators.pyより
		res = None
		try:
			res = adfuller([float(xdlist[keySize+1]) for xdlist in dlist])
		except LinAlgError:
			res = np.NaN, np.NaN, np.NaN
		except ValueError:  # occurs if sample size is too small
			res = np.NaN, np.NaN, np.NaN
		
		rf2.write(id +["augmented_dickey_fuller__attr_teststat",res[0]])
		rf2.write(id +["augmented_dickey_fuller__attr_pvalue",res[1]])
		rf2.write(id +["augmented_dickey_fuller__attr_usedlag",res[2]])



#autocorrelation agg ここはもっといい方法ありそう
funcList5=[]
f5 = nm.mjoin(k=keyfld,i=baseDATA,m=sumDATA,f="mean,var,count") 
lags=[1,2,3,4,5,6,7,8,9]
for lag in lags:
	f5_1 = nm.mslide(k=keyfld,s=seqfld, i=f5,f="val:val_L",t=lag,l=True)
	f5_1 <<= nm.mcal(c='(${val}-${mean})*(${val_L}-${mean})',a="val_m") 
	f5_1 <<= nm.msum(k=keyfld,f="val_m") 
	f5_1 <<= nm.msetstr(a="lag",v=lag)
	f5_1 <<= nm.mcal(c="${val_m}/(${count}-${lag})/${var}",a="autocorrelation_lag_%d"%(lag))
	f5_1 <<= nm.m2cross(k=keyfld,f="autocorrelation_lag_%d"%(lag),a="way,val",o=rlsDIR+"/rls5_%d.csv"%(lag))
	funcList5.append(f5_1)

nm.runs(funcList5)

#binned_entropy
funcList6=[]
maxbins=[10]
for maxbin in maxbins:
	f6 =   nm.mbucket(k=keyfld,f="val:val_no",n=maxbin,i=baseDATA,rng=True) 
	f6 <<= nm.mcount(k=keyfld+["val_no"],a="hcount")
	f6 <<= nm.mjoin(k=keyfld,m=sumDATA,f="count")
	f6 <<= nm.mcal(c='(${hcount}/${count})*ln(${hcount}/${count})',a="probs")
	f6 <<= nm.msum(k=keyfld,f="probs")
	f6 <<= nm.mcal(c='${probs}*-1',a="binned_entropy_maxbin_%d"%(maxbin))
	f6 <<= nm.m2cross(k=keyfld,f="binned_entropy_maxbin_%d"%(maxbin),a="way,val",o=rlsDIR+"/rls6_%d.csv"%(maxbin))
	funcList6.append(f6)

nm.runs(funcList6)

#c3
funcList7=[]
lags=[1,2,3]
for lag in lags:
	f7 =   nm.mslide(k=keyfld,s=seqfld, i=baseDATA,f="val:val_L",t=lag,n=True,l=True)
	f7 <<= nm.mslide(k=keyfld,s=seqfld,f="val:val_L2",t=lag*2,l=True)
	f7 <<= nm.mcal(c="${val}*${val_L}*${val_L2}",a="rls")
	f7 <<= nm.msummary(k=keyfld,c="mean:c3_lag_%d"%(lag),f="rls")
	f7 <<= nm.m2cross(k=keyfld,f="c3_lag_%d"%(lag),a="way,val",o=rlsDIR+"/rls7_%d.csv"%(lag))
	funcList7.append(f7)
		
nm.runs(funcList7)


#change_quantiles
quantile=[ 
[0.0,0.2],[0.0,0.4],[0.0,0.6],[0.0,0.8],[0.0,1.0],
[0.2,0.4],[0.2,0.6],[0.2,0.8],[0.2,1.0],[0.8,1.0],
[0.4,0.6],[0.4,0.8],[0.4,1.0],[0.6,0.8],[0.6,1.0]
]
absbool =[True,False]
funclist8=[]
funclist8_all=[]

f8_00 =   nm.mjoin(i=baseDATA,k=keyfld,f="count",m=sumDATA)
f8_00 <<= nm.mnumber(k=keyfld,s="val%n", a="qt",e="skip")


for ql,qh in quantile:
	for abs_b in absbool:
		#f8_0 =   nm.mjoin(i=baseDATA,k=keyfld,f="count",m=sumDATA)
		#f8_0 <<= nm.mnumber(k=keyfld,s="val%n", a="qt",e="skip")
		f8_0 = nm.mcal(c="${count}*%g<=${qt}&&${count}*%g>${qt}"%(ql,qh),i=f8_00,a="qtbool")
		f8_0 <<= nm.mslide(k=keyfld,s=seqfld,r=True,f="qtbool:qtbool1")
		f8_0 <<= nm.mcal(c="${qtbool}*${qtbool1}",a="ind")

		f8_1 = nm.mslide(k=keyfld,s=seqfld,r=True,i=baseDATA,f="val:valx")
		if abs_b:
			f8_1 <<= nm.mcal(c="abs(${val}-${valx})",a="diff")
		else:
			f8_1 <<= nm.mcal(c="${val}-${valx}",a="diff")
				
		f8_1 <<= nm.mjoin(k=keyfld+seqfldB,f="ind" ,m=f8_0 )
		f8_1 <<= nm.mtonull(f="ind" ,v=0)
		f8_1 <<= nm.mcal(c="${diff}*${ind}" ,a="dval")
		f8_1 <<= nm.msummary(k=keyfld,f="dval",c="mean,var")
		f8_1 <<= nm.mnullto(f="mean,var",v=0)
		f8_1 <<= nm.m2cross(k=keyfld,f="mean,var",a="k,val")
		f8_1 <<= nm.msetstr(a="abs_b,qh,ql",v=[float(abs_b),qh,ql])
		f8_1 <<= nm.mcal(c='"change_quantiles_agg_"+$s{k}+"_isabs_"+$s{abs_b}+"_qh_"+$s{qh}+"_ql_"+$s{ql}',a="way")
		f8_1 <<= nm.mcut(f=keyfld+["way","val"],o=rlsDIR+"/rls8_%s_%g_%g.csv"%(abs_b,qh,ql))
		#funclist8.append(f8_1)
		funclist8_all.append(f8_1)
	
	#if len(funclist8)>10:
		#nm.runs(funclist8)	
		#funclist8=[]
		
		
#nm.drawModels(funclist9,"check.html")
# 全部まとめ動かすファイルの数上限
# (10240 on mac 管理者でなくて変えれる上限っぽい)を超える
#if len(funclist8)>0:
#	nm.runs(funclist8) 
nm.drawModelsD3(funclist8_all,"output.html") 
#print("a st")
nm.runs(funclist8_all) 

#print("a ed")

#cid_ce normalise (normalizeのsdチェック)

#f9 = nm.mnormalize(k="id",c="z",i=base,f="F_x:F_xn")
#f9 <<= nm.mslide(k="id",s="time%n",f="F_x:F_xx,F_xn:F_xxn")
#f9 <<= nm.mcal(c="(${F_xx}-${F_x})^2,(${F_xxn}-${F_xn})^2" , a="diff,diffn")
#f9 <<= nm.msum(k=id,f="diff,diffn")
#f9 <<= nm.mcal(c="sqrt(${diff}),sqrt(${diffn})",a="cid_ce,cid_ce_n",o="rls9.csv")
#f9.run()

f9 = nm.mjoin(k=keyfld,i=baseDATA,m=sumDATA,f="mean,sd")
f9 <<= nm.mcal(c="(${val}-${mean})/${sd}",a="valn")
f9 <<= nm.mslide(k=keyfld,s=seqfld,f="val:valx,valn:valxn")
f9 <<= nm.mcal(c="(${valx}-${val})^2,(${valxn}-${valn})^2" , a="diff,diffn")
f9 <<= nm.msum(k=keyfld,f="diff,diffn")
f9 <<= nm.mcal(c="sqrt(${diff}),sqrt(${diffn})",a="cid_ce,cid_ce_n")
f9 <<= nm.m2cross(k=keyfld,f="cid_ce,cid_ce_n",a="way,val",o=rlsDIR+"/rls9.csv")
f9.run()

#count_above_mean,count_below_mean
f10 =   nm.mjoin(k=keyfld,m=sumDATA,f="mean",i=baseDATA)
f10 <<= nm.mcal(c="${val}>${mean},${val}<${mean}",a="count_above_mean,count_below_mean")
f10 <<= nm.msum(k=keyfld,f="count_above_mean,count_below_mean")
f10 <<= nm.m2cross(k=keyfld,f="count_above_mean,count_below_mean",a="way,val",o=rlsDIR+"/rls10.csv")
f10.run()

#Continuous WaveletTransform
widths_s=[[2, 5, 10, 20]]
coeff_s = range(15)
w_s=[2,5,10,20]

from scipy.signal import cwt,ricker
head = keyfld[:]
for widths in widths_s:
	for coeff in coeff_s:
		for w in w_s:
			head.append("cwt_coefficients__widths_[{}]__coeff_{}__w_{}".format("_".join(list(map(str, widths))), coeff, w))

rlsf_3 = temo.file()

with mcsvout(rlsf_3,f=head) as rf3:

	for dlist in nm.readcsv(baseDATA).keyblock(keyfld,seqfld):
		rls =dlist[0][0:keySize]
		#以下
		#/tsfresh/feature_extraction/feature_calculators.pyより
		for widths in widths_s:

			calculated_cwt_for_widths = cwt([float(xdlist[keySize+1]) for xdlist in dlist], ricker, widths)

			for coeff in coeff_s:
				for w in w_s:
					i = widths.index(w)
					if calculated_cwt_for_widths.shape[1] <= coeff:
						rls.append(np.NaN)
					else:
						rls.append(calculated_cwt_for_widths[i, coeff])

		rf3.write(rls)

nm.m2cross(i=rlsf_3,k=keyfld,f="cwt_coefficients__widths_*",a="way,val",o=rlsDIR+"/rlsf_3.csv").run()



#energy_ratio_by_chunks
funclist11=[]
num_segments=[10]
segment_focus=[0,1,2,3,4,5,6,7,8,9]

#rls1.csv　で二乗和計算済み
#sumary.csvでcount済み
for ns in num_segments:
	for sf in segment_focus:
		f11 = nm.mjoin(k=keyfld,i=baseDATA,m=sumDATA,f="count,sd")
		f11 <<= nm.mjoin(k=keyfld,m=div2DATA,f="abs_energy:sqsum")
		f11 <<= nm.mcal(c="int(${count}/%d)"%ns,a="sl")
		f11 <<= nm.mcal(c="%d*${sl},min(%d*${sl},${count})"%(sf,sf+1),a="st,ed")
		f11 <<= nm.msel(c="${__seq}>=${st}&&${__seq}<${ed}")
		f11 <<= nm.mcal(c="${val}^2",a="d2")
		f11 <<= nm.msum(k=keyfld,f="d2")
		f11 <<= nm.mcal(c="${d2}/${sqsum}",a="energy_ratio_by_chunks_seg_%d_seg_focus_%d"%(ns,sf))
		f11 <<= nm.m2cross(k=keyfld,f="energy_ratio_by_chunks_seg_%d_seg_focus_%d"%(ns,sf),a="way,val",o=rlsDIR+"/rls11_%d_%d.csv"%(ns,sf))
		funclist11.append(f11)

nm.runs(funclist11)



#フーリエ変換
#fft_aggregated 

with mcsvout(rlsDIR+"/rlsf_4.csv",f=keyfld+["way","val"]) as rf4:

	for dlist in nm.readcsv(baseDATA).keyblock(keyfld,seqfld):
		id = dlist[0][0:keySize]
		#以下
		#/tsfresh/feature_extraction/feature_calculators.pyより
		y = np.abs(np.fft.rfft([float(xdlist[keySize+1]) for xdlist in dlist]))
		#msumaryでできる？
		centroid = y.dot(np.arange(len(y))**1) / y.sum()
		moment2 = y.dot(np.arange(len(y))**2) / y.sum()
		variance = moment2 - centroid ** 2
		if variance < 0.5:
			skew = np.nan
			kurtosis = np.nan
		else:
			moment3 = y.dot(np.arange(len(y))**3) / y.sum()
			skew = ( moment3 - 3 * centroid * variance - centroid**3 ) / variance**(1.5)
						
			kurtosis =( (y.dot(np.arange(len(y))**4) / y.sum()) - 4 * centroid * moment3
                + 6 * moment2 * centroid**2 - 3*centroid) / variance**2

		rf4.write(id+["fft_aggregated_centroid",centroid])
		rf4.write(id+["fft_aggregated_variance",variance])
		rf4.write(id+["fft_aggregated_skew",skew])
		rf4.write(id+["fft_aggregated_kurtosis",kurtosis])



#fft_coefficient__coeff_0
coeff_s =range(100)
agg_s =["real","imag","abs","angle"]

head= keyfld[:]
for coeff in coeff_s:
	for agg in agg_s:
		head.append("fft_coefficient_coeff_{}__attr_{}".format(coeff,agg))

rlsf_5 = temo.file()

with mcsvout(rlsf_5,f=head) as rf5:


	for dlist in nm.readcsv(baseDATA).keyblock(keyfld,seqfld):
		rls =  dlist[0][0:keySize]
		#以下
		#/tsfresh/feature_extraction/feature_calculators.pyより
		fft = np.fft.rfft([float(xdlist[keySize+1]) for xdlist in dlist])

		for coeff in coeff_s:
			if coeff < len(fft):
				rls.append(fft[coeff].real)
				rls.append(fft[coeff].imag)
				rls.append(np.abs(fft[coeff]))
				rls.append(np.angle(fft[coeff], deg=True))
			else:
				rls.append(np.NaN)
				rls.append(np.NaN)
				rls.append(np.NaN)
				rls.append(np.NaN)

		rf5.write(rls)		

nm.m2cross(i=rlsf_5,k=keyfld,f="fft_coefficient_coeff_*",a="way,val",o=rlsDIR+"/rlsf_5.csv").run()


#first_location_of_maximum
#first_location_of_minimum
#last_location_of_maximum
#last_location_of_minimum

f12_1 = nm.mbest(k=keyfld,s="val%nr,__seq%n",size=1,i=baseDATA)
f12_1 <<= nm.mjoin(k=keyfld,m=sumDATA,f="count")
f12_1 <<= nm.mcal(c="${__seq}/${count}",a="first_location_of_maximum" )
f12_1 <<= nm.m2cross(k=keyfld,f="first_location_of_maximum",a="way,val",o=rlsDIR+"/rls12_1.csv")

f12_1.run()

f12_2 = nm.mbest(k=keyfld,s="val%n,__seq%n",size=1,i=baseDATA)
f12_2 <<= nm.mjoin(k=keyfld,m=sumDATA,f="count")
f12_2 <<= nm.mcal(c="${__seq}/${count}",a="first_location_of_minimum")
f12_2 <<= nm.m2cross(k=keyfld,f="first_location_of_minimum",a="way,val",o=rlsDIR+"/rls12_2.csv")
f12_2.run()

f12_3 = nm.mbest(k=keyfld,s="val%nr,__seq%nr",size=1,i=baseDATA)
f12_3 <<= nm.mjoin(k=keyfld,m=sumDATA,f="count")
f12_3 <<= nm.mcal(c="(${__seq}+1)/${count}",a="last_location_of_maximum")
f12_3 <<= nm.m2cross(k=keyfld,f="last_location_of_maximum",a="way,val",o=rlsDIR+"/rls12_3.csv")
f12_3.run()

f12_4 = nm.mbest(k=keyfld,s="val%n,__seq%nr",size=1,i=baseDATA)
f12_4 <<= nm.mjoin(k=keyfld,m=sumDATA,f="count")
f12_4 <<= nm.mcal(c="(${__seq}+1)/${count}",a="last_location_of_minimum" ,o="rls12_4.csv")
f12_4 <<= nm.m2cross(k=keyfld,f="last_location_of_minimum",a="way,val",o=rlsDIR+"/rls12_4.csv")
f12_4.run()




#friedrich_coefficients
#max_langevin_fixed_point
m_s=[3]
r_s=[30]
for m in m_s:
	for r in r_s:
		f13 =   nm.mslide(k=keyfld,s=seqfld,f="val:valn",i=baseDATA)
		f13 <<= nm.mcal(c="${valn}-${val}",a="diff")
		f13 <<= nm.mbucket(k=keyfld,f="val:val_no",n=r) 

		f13_1 = nm.mcount(k=keyfld+["val_no"],i=f13,a="maxcnt")
		f13_1 <<= nm.mbest(k=keyfld ,s="maxcnt%nr",size=1)

		f13_2 = nm.mcount(k=keyfld,i=f13,a="tcnt")
		f13_2 <<= nm.mjoin(k=keyfld,f="maxcnt",m=f13_1)
		f13_2 <<= nm.msel(c="${tcnt}<%d&&${maxcnt}!=1"%(r))
		
		f13_4 = nm.mcommon(k=keyfld,m=f13_2,i=f13,r=True)
		f13_4 <<= nm.mavg(k=keyfld+["val_no"],f="val,diff") 
		f13_4 <<= nm.mcut(f=keyfld+["val_no","val","diff"]) 
		f13_4 <<= nm.mdelnull(f="val,diff")

		head = keyfld[:]
		for q in range(m, -1, -1):		
			head.append("friedrich_coefficients_m_{}__r_{}__coeff_{}".format(m, r, q))
		head.append("max_langevin_fixed_point")

		rlsf_13 = temo.file()
		with mcsvout(rlsf_13,f=head) as rf13:
			for dlist in f13_4.keyblock(keyfld,["val_no%n"]):

				rtn =  dlist[0][0:keySize]
				#以下
				#/tsfresh/feature_extraction/feature_calculators.pyより

				try:
					x = [float(xdlist[keySize+1]) for xdlist in dlist]
					y = [float(xdlist[keySize+2]) for xdlist in dlist]
					rls = np.polyfit(x, y, deg=m)
				except (np.linalg.LinAlgError, ValueError):
					rls = [np.NaN] * (m + 1)

				for q in range(m+1):
					rtn.append(rls[q])

				try:
					rtn.append(np.max(np.real(np.roots(rls))))

				except (np.linalg.LinAlgError, ValueError):
					pass
	
				rf13.write(rtn)

		nm.m2cross(i=rlsf_13,k=keyfld,f="friedrich_coefficients_*,max_langevin_fixed_point",a="way,val",o=rlsDIR+'/rlsf_13_{}_{}.csv'.format(m,r)).run()

			

#F_x__has_duplicate
#F_x__has_duplicate_max
#F_x__has_duplicate_min
f14 = nm.mcount(k=keyfld+["val"],a="dcnt",i=baseDATA)

f14_1 = nm.mcount(k=keyfld,a="ddcnt",i=f14)
f14_1 <<= nm.mjoin(k=keyfld,f="count",m=sumDATA)
f14_1 <<= nm.mcal(c="${ddcnt}!=${count}",a="has_duplicate") 
f14_1 <<= nm.m2cross(k=keyfld,f="has_duplicate",a="way,val",o=rlsDIR+"/rls14_1.csv")

f14_2 = nm.mbest(k=keyfld,s="val%n",size=1,i=f14)
f14_2 <<= nm.mcal(c="${dcnt}>1",a="has_duplicate_min")
f14_2 <<= nm.m2cross(k=keyfld,f="has_duplicate_min",a="way,val",o=rlsDIR+"/rls14_2.csv")


f14_3 = nm.mbest(k=keyfld,s="val%nr",size=1,i=f14)
f14_3 <<= nm.mcal(c="${dcnt}>1",a="has_duplicate_max")
f14_3 <<= nm.m2cross(k=keyfld,f="has_duplicate_max",a="way,val",o=rlsDIR+"/rls14_3.csv")

nm.runs([f14_1,f14_2,f14_3])





#index_mass_quantile
q_s=[0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9]

for q in q_s:
	f15_0 = nm.mcal(c="abs(${val})",a="valabs",i=baseDATA)
	f15_1 = f15_0.msum(k=keyfld,f="valabs")

	f15 =   nm.maccum(k=keyfld,s=seqfld,f="valabs:valabs_a",i=f15_0)
	f15 <<= nm.mjoin(k=keyfld,f="valabs:valabs_ttl",m=f15_1)
	f15 <<= nm.mjoin(k=keyfld,f="count",m=sumDATA)
	f15 <<= nm.mcal(c="(${valabs_a}/${valabs_ttl})>=%g"%(q),a="mc")
	f15 <<= nm.mbest(k=keyfld,s="mc%nr,__seq%n",size=1)
	f15 <<= nm.mcal(c="(${__seq}+1)/${count}",a="index_mass_quantile_%g"%(q))
	f15 <<= nm.m2cross(k=keyfld,f="index_mass_quantile_%g"%(q),a="way,val",o=rlsDIR+"/rls15_%g.csv"%(q))
	f15.run()




#large_standard_deviation
r_s=[0.05,0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55,0.6,0.65,0.7,0.75,0.8,0.85,0.9,0.95]

f16 =  nm.msummary(k=keyfld,f="val",c="min,max,sd",i=baseDATA)
f16 <<=  nm.mcal(c="${max}-${min}",a="diff")

for r in r_s:
	f16 <<=  nm.mcal(c="${sd}>${diff}*%g"%(r),a="arge_standard_deviation_%g"%(r) )

f16 <<=  nm.m2cross(k=keyfld,f="arge_standard_deviation_*",a="way,val",o=rlsDIR+"/rls16.csv")

f16.run()


#linear_trend (linregress)
#x=time,y=F_x 
f17_0 = nm.mstats(k=keyfld,i=baseDATA,f="__seq,val",c="mean")

f17_1 = nm.msim(k=keyfld,i=baseDATA,f="__seq,val",c="covar") # covar Sxy == Syx (r_num)
f17_2 = nm.mstats(k=keyfld,f="__seq:Sxx,val:Syy",c="var",i=baseDATA) # Sxx=> time ,Syy F_x 
f17_2 <<= nm.mcal(c="sqrt(${Sxx}*${Syy})",a="r_den")
f17_2 <<= nm.mjoin(k=keyfld,m=f17_1,f="covar")
f17_2 <<= nm.mjoin(k=keyfld,m=sumDATA,f="count")
f17_2 <<= nm.mjoin(k=keyfld,m=f17_0,f="__seq:xmean,val:ymean")
f17_2 <<= nm.mcal(c="${count}-2",a="df")
f17_2 <<= nm.mcal(c="if(${r_den}==0,0,${covar}/${r_den})",a="linear_trend_rvalue")
f17_2 <<= nm.mcal(c="${covar}/${Sxx}",a="linear_trend_slope")
f17_2 <<= nm.mcal(c="${ymean}-(${linear_trend_slope}*${xmean})",a="linear_trend_intercept")
f17_2 <<= nm.mcal(c="${linear_trend_rvalue}*sqrt(${df}/((1-${linear_trend_rvalue})*(1+${linear_trend_rvalue})))",a="t")
f17_2 <<= nm.mcal(c="sqrt((1-${linear_trend_rvalue}^2)*${Syy}/${Sxx}/${df})",a="linear_trend_stder")
cval= [ "Syy","Sxx","r_den","covar","count","xmean","ymean",
				"df","linear_trend_rvalue","linear_trend_slope","linear_trend_intercept","t","linear_trend_stder"]
f17_2 <<= nm.mcut(f=keyfld+cval)

rlsf_17 = temo.file()
with mcsvout(rlsf_17,f=keyfld+cval+["linear_trend_pvalue"]) as rf17:

	from scipy.stats import distributions
	for lin in f17_2:
		t=float(lin[12+keySize])
		df=float(lin[8+keySize])
		lin.append(2 * distributions.t.sf(np.abs(t), df))
		rf17.write(lin)

outval=["linear_trend_rvalue","linear_trend_slope","linear_trend_intercept","linear_trend_stder","linear_trend_pvalue"]
nm.m2cross(i=rlsf_17,k=keyfld,f=outval,a="way,val",o=rlsDIR+"/rls17.csv").run()

#covar=>r_num
#mm=r_den
#prob = 2 * distributions.t.sf(np.abs(t), df) =>pvalue
#distributions.t.sfは
#stdtr(df, t) 
# gamma((df+1)/2)/(sqrt(df*pi)*gamma(df/2)) 
# *integral((1+x**2/df)**(-df/2-1/2), x=-inf..t)


#longest_strike_above_mean,longest_strike_below_mean
f18_1 = nm.mjoin(k=keyfld,m=sumDATA,f="mean",i=baseDATA)
f18_1 <<= nm.msortf(f=keyfld+seqfld)
f18_1 <<= nm.mcal(c="${mean}<=${val}",a="above")
f18_1 <<= nm.mcount(q=True ,k=keyfld+["above"],a="a_count")
f18_1 <<= nm.mbest(k=keyfld,s="above%nr,a_count%nr",size=1)
f18_1 <<= nm.mcal(c="if(${above}==0,0,${a_count})",a="longest_strike_above_mean")
f18_1 <<= nm.m2cross(k=keyfld,f="longest_strike_above_mean",a="way,val",o=rlsDIR+"/rls18_1.csv")
f18_1.run()

f18_2 = nm.mjoin(k=keyfld,m=sumDATA,f="mean",i=baseDATA)
f18_2 <<= nm.msortf(f=keyfld+seqfld)
f18_2 <<= nm.mcal(c="${mean}>=${val}",a="below")
f18_2 <<= nm.mcount(q=True ,k=keyfld+["below"],a="b_count")
f18_2 <<= nm.mbest(k=keyfld,s="below%nr,b_count%nr",size=1)
f18_2 <<= nm.mcal(c="if(${below}==0,0,${b_count})",a="longest_strike_below_mean")
f18_2 <<= nm.m2cross(k=keyfld,f="longest_strike_below_mean",a="way,val",o=rlsDIR+"/rls18_2.csv")
f18_2.run()



#mean_abs_change
#mean_change
f19_1 = nm.mslide(k=keyfld,s=seqfld,f="val:valn",i=baseDATA)
f19_1 <<= nm.mcal(c="${valn}-${val},abs(${valn}-${val})",a="mean_change,mean_abs_change")
f19_1 <<= nm.mavg(k=keyfld,f="mean_change,mean_abs_change")
f19_1 <<= nm.m2cross(k=keyfld,f="mean_change,mean_abs_change",a="way,val",o=rlsDIR+"/rls19_1.csv")
f19_1.run()
#mean_second_derivative_central
f19_2 = nm.mslide(k=keyfld,s=seqfld,f="val:valn_",t=2,i=baseDATA)
f19_2 <<= nm.mcal(c="(${valn_2}-2*${valn_1}+${val})/2",a="mean_second_derivative_central")
f19_2 <<= nm.mavg(k=keyfld,f="mean_second_derivative_central")
f19_2 <<= nm.m2cross(k=keyfld,f="mean_second_derivative_central",a="way,val",o=rlsDIR+"/rls19_2.csv")
f19_2.run()


#number_crossing_m
funclist20 =[]
m_s =[-1,0,1]
for m in m_s:
	f20 =   nm.mcal(c="${val}>%g"%(m),a="pos",i=baseDATA)
	f20 <<= nm.mslide(k=keyfld,s=seqfld,f="pos:posN")
	f20 <<= nm.mcal(c="${pos}!=${posN}",a="diffT")
	f20 <<= nm.mcount(k=keyfld+["diffT"],a="cnt")
	f20 <<= nm.mbest(k=keyfld,s="diffT%nr",size=1)
	f20 <<= nm.mcal(c="if(${diffT}==0,0,${cnt})",a="number_crossing_m_%g"%(m))
	f20 <<= nm.m2cross(k=keyfld,f="number_crossing_m_%g"%(m),a="way,val",o=rlsDIR+"/rls20.csv")
	funclist20.append(f20)

nm.runs(funclist20)


#number_cwt_peaks
from scipy.signal import find_peaks_cwt,ricker
n_s=[1,5]
for n in n_s:
	with mcsvout(rlsDIR+'/rlsf_6_%d.csv'%(n),f=keyfld+["way","val"]) as rf6:
		for dlist in nm.readcsv(baseDATA).keyblock(keyfld,seqfld):
			rls =  dlist[0][0:keySize]
			rls.append("number_cwt_peaks_%d"%(n)) 
			rls.append(len(find_peaks_cwt(vector=[float(xdlist[keySize+1]) for xdlist in dlist], widths=np.array(list(range(1, n + 1))), wavelet=ricker)))
			rf6.write(rls)


#number_peaks
funclist21 =[]
n_s = [1,3,5,10,50]
for n in n_s:
	f21_1 = nm.mslide(k=keyfld,s=seqfld,t=n,f="val:val_a_",i=baseDATA)
	f21_2 = nm.mslide(k=keyfld,s=seqfld,t=n,f="val:val_b_",i=baseDATA,r=True)
	f21   = nm.mjoin(k=keyfld+seqfldB,f="val_b_*",i=f21_1,m=f21_2)
	f21 <<= nm.mdelnull(f="val_a_*,val_b_*")
	f21 <<= nm.mcal(c='max(${val_a_*},${val_b_*})',a="maxv")
	f21 <<= nm.mcal(c='${val}>${maxv}',a="number_peaks_%d"%(n))
	f21 <<= nm.msum(k=keyfld,f="number_peaks_%d"%(n))
	f21 <<= nm.m2cross(k=keyfld,f="number_peaks_%d"%(n),a="way,val",o=rlsDIR+"/rls21_%d.csv"%n)
	funclist21.append(f21)

nm.runs(funclist21)

#partial_autocorrelation
from statsmodels.tsa.stattools import pacf
lag_s = [0,1,2,3,4,5,6,7,8,9]
max_demanded_lag = max(lag_s)

head= keyfld[:]
for lag in lag_s:
	head.append("partial_autocorrelation_lag_{}".format(lag))

rlsf_8 = temo.file()

with mcsvout(rlsf_8,f=head) as rf8:

	for dlist in nm.readcsv(baseDATA).keyblock(keyfld,seqfld):

		rtn =  dlist[0][0:keySize]
		x=[float(xdlist[keySize+1]) for xdlist in dlist]
		#以下
		#/tsfresh/feature_extraction/feature_calculators.pyより
		n = len(x)
		if n <= 1:
			pacf_coeffs = [np.nan] * (max_demanded_lag + 1)
		else:
			if (n <= max_demanded_lag):
				max_lag = n - 1
			else:
				max_lag = max_demanded_lag
			pacf_coeffs = list(pacf(x, method="ld", nlags=max_lag))
			pacf_coeffs = pacf_coeffs + [np.nan] * max(0, (max_demanded_lag - max_lag))

		for lag in lag_s:
			rtn.append(pacf_coeffs[lag])

		rf8.write(rtn)

nm.m2cross(i=rlsf_8,k=keyfld,f="partial_autocorrelation_lag_*",a="way,val",o=rlsDIR+"/rlsf_8.csv").run()




#percentage_of_reoccurring_datapoints_to_all_datapoints
f23_1 = nm.mcount(k=keyfld+["val"],a="cnt",i=baseDATA)
f23_1 <<= nm.mcal(c="${cnt}>1",a="reocur")
f23_1 <<= nm.msummary(k=keyfld,f="reocur",c="sum,count")
f23_1 <<= nm.mcal(c="${sum}/${count}",a="percentage_of_reoccurring_datapoints_to_all_datapoints")
f23_1 <<= nm.m2cross(k=keyfld,f="percentage_of_reoccurring_datapoints_to_all_datapoints",a="way,val",o=rlsDIR+"/rls23_1.csv")
f23_1.run()
#percentage_of_reoccurring_values_to_all_values
f23_2 = nm.mcount(k=keyfld+["val"],a="cnt",i=baseDATA)
f23_2 <<= nm.mcal(c="if(${cnt}>1,${cnt},0)",a="reocur")
f23_2 <<= nm.msum(k=keyfld,f="reocur")
f23_2 <<= nm.mjoin(k=keyfld,m=sumDATA,f="count")
f23_2 <<= nm.mcal(c="${reocur}/${count}",a="percentage_of_reoccurring_values_to_all_values")
f23_2 <<= nm.m2cross(k=keyfld,f="percentage_of_reoccurring_values_to_all_values",a="way,val",o=rlsDIR+"/rls23_2.csv")
f23_2.run()



#quantile
qt_s=[0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9]
for qt in qt_s:
	f24_0 = nm.msetstr(a="qtRate",v=qt,i=sumDATA)
	f24_0 <<= nm.mcal(a="T",c="1-${qtRate}+${count}*${qtRate}")
	f24_0 <<= nm.mcal(a="T1",c="int(${T})")
	f24_0 <<= nm.mcal(a="T2",c="if(fract(${T})==0,${T1},${T1}+1)")
	f24_1 = nm.mnumber(i=baseDATA,s="val%n",a="qtNo",k=keyfld,S=1)
	f24_1 <<= nm.msortf(f=keyfld+["qtNo"])
	f24_0 <<= nm.mjoin(k=keyfld+["T1"],K=keyfld+["qtNo"],f="val:X1",m=f24_1)
	f24_0 <<= nm.mjoin(k=keyfld+["T2"],K=keyfld+["qtNo"],f="val:X2",m=f24_1)
	f24_0 <<= nm.mcal(a="quantile_q_%g"%(qt),c="if(${T1}==${T2},${X1},(${T2}-${T})*${X1}+(${T}-${T1})*${X2})")
	f24_0 <<= nm.m2cross(k=keyfld,f="quantile_q_%g"%(qt),a="way,val",o=rlsDIR+"/rls24_%g.csv"%(qt))
	f24_0.run()


#range_count
mm_s = [[1,-1]]
for max, min in mm_s:
	f25 = nm.mcal(i=baseDATA,c="${val}>=%g&&${val}<%g"%(min,max) ,a="range_coun_%g_%g"%(min,max))
	f25 <<= nm.msum(k=keyfld,f="range_coun_%g_%g"%(min,max))
	f25 <<= nm.m2cross(k=keyfld,f="range_coun_%g_%g"%(min,max),a="way,val",o=rlsDIR+"/rls25_%g_%g.csv"%(min,max))
	f25.run()


#ratio_beyond_r_sigma
r_s = [0.5,1,1.5,10,2,2.5,3,5,6,7]
for r in r_s:
	f26 =   nm.mjoin(k=keyfld,m=sumDATA,f="mean,sd,count",i=baseDATA)
	f26 <<=	nm.mcal(c="(abs(${val}-${mean}))>(%g*${sd})"%(r),a="ratio_beyond_r_sigma_b")
	f26 <<=	nm.msum(k=keyfld,f="ratio_beyond_r_sigma_b")
	f26 <<=	nm.mcal(c="${ratio_beyond_r_sigma_b}/${count}",a="ratio_beyond_r_sigma%g"%(r))
	f26 <<= nm.m2cross(k=keyfld,f="ratio_beyond_r_sigma%g"%(r),a="way,val",o=rlsDIR+"/rls26_%g.csv"%(r))
	f26.run()


#ratio_value_number_to_time_series_length
f27 = nm.msummary(k=keyfld,f="val",c="count,ucount",i=baseDATA)
f27 <<= nm.mcal(c="${ucount}/${count}",a="ratio_value_number_to_time_series_length")
f27 <<= nm.m2cross(k=keyfld,f="ratio_value_number_to_time_series_length",a="way,val",o=rlsDIR+"/rls27.csv")
f27.run()


#sample_entropy (もとが間違ってるようなきが...)
f28_0 = nm.mslide(k=keyfld,s=seqfld,f="val:valn",i=baseDATA)
f28_1 = nm.mslide(k=keyfld,s=seqfld,f="val:valn",l=True,t=2,i=baseDATA)

f28_2 = nm.mcombi(k=keyfld,s=seqfld,f=seqfldB,a="t1,t2",n=2,i=f28_0)
f28_2 <<= nm.mjoin(k=keyfld+["t1"],K=keyfld+seqfldB ,m=f28_0,f="val:t1_V1,valn:t1_V2")
f28_2 <<= nm.mjoin(k=keyfld+["t2"],K=keyfld+seqfldB ,m=f28_0,f="val:t2_V1,valn:t2_V2")
f28_2 <<= nm.mjoin(k=keyfld,m=sumDATA,f="sd")
f28_2 <<= nm.mcal(c="abs(${t2_V1}-${t1_V1})<${sd}*0.2||abs(${t2_V2}-${t1_V2})<${sd}*0.2",a="B")
f28_2 <<= nm.msum(k=keyfld,f="B")

f28_3 = nm.mcombi(k=keyfld,s=seqfld,f=seqfldB ,a="t1,t2",n=2,i=f28_1)
f28_3 <<= nm.mjoin(k=keyfld+["t1"],K=keyfld+seqfldB, m=f28_1,f="val:t1_V1,valn:t1_V2")
f28_3 <<= nm.mjoin(k=keyfld+["t2"],K=keyfld+seqfldB, m=f28_1,f="val:t2_V1,valn:t2_V2")
f28_3 <<= nm.mjoin(k=keyfld,m=sumDATA,f="sd")
f28_3 <<= nm.mcal(c="abs(${t2_V1}-${t1_V1})<${sd}*0.2||abs(${t2_V2}-${t1_V2})<${sd}*0.2",a="A")
f28_3 <<= nm.msum(k=keyfld,f="A")

f28 =   nm.mjoin(k=keyfld,i=f28_2,m=f28_3,f="A")
f28 <<= nm.mcal(c="ln(${A}/${B})*-1",a="sample_entropy")
f28 <<= nm.m2cross(k=keyfld,f="sample_entropy",a="way,val",o=rlsDIR+"/rls28.csv")
f28.run()



#spkt_welch_density
# welch　＝＞フーリエ変換必要
from scipy.signal import welch
coeff_s=[2,5,8]

head= keyfld[:]
for coeff in coeff_s:
	head.append("spkt_welch_density__coeff_{}".format(coeff))


rlsf_9 = temo.file()
with mcsvout(rlsf_9,f=head) as rf9:

	for dlist in nm.readcsv(baseDATA).keyblock(keyfld,seqfld):

		rtn =  dlist[0][0:keySize]
		id= dlist[0][0] 
		#以下
		#/tsfresh/feature_extraction/feature_calculators.pyより
		freq, pxx = welch([float(xdlist[keySize+1]) for xdlist in dlist])

		if len(pxx) <= np.max(coeff_s):  # There are fewer data points in the time series than requested coefficients
			# filter coefficients that are not contained in pxx
			reduced_coeff = [coefficient for coefficient in coeff_s if len(pxx) > coefficient]
			not_calculated_coefficients = [coefficient for coefficient in coeff_s
																				if coefficient not in reduced_coeff]

			# Fill up the rest of the requested coefficients with np.NaNs
			rls = list(pxx[reduced_coeff]) + [np.NaN] * len(not_calculated_coefficients)
		else:
			rls = pxx[coeff_s]

		rtn.extend(rls)
		rf9.write(rtn)


nm.m2cross(i=rlsf_9,k=keyfld,f="spkt_welch_density__coeff_*",a="way,val",o=rlsDIR+"/rlsf_9.csv").run()



#sum_of_reoccurring_data_points
f29 =   nm.mcount(k=keyfld+["val"],a="cnt",i=baseDATA)
f29 <<= nm.mcal(c="if(${cnt}==1,0,${cnt}*${val})",a="sum_of_reoccurring_data_points")
f29 <<= nm.msum(k=keyfld,f="sum_of_reoccurring_data_points")
f29 <<= nm.m2cross(k=keyfld,f="sum_of_reoccurring_data_points",a="way,val",o=rlsDIR+"/rls29.csv")
f29.run()

#sum_of_reoccurring_values
f30 =   nm.mcount(k=keyfld+["val"],a="cnt",i=baseDATA)
f30 <<= nm.mcal(c="if(${cnt}==1,0,${val})",a="sum_of_reoccurring_values")
f30 <<= nm.msum(k=keyfld,f="sum_of_reoccurring_values")
f30 <<= nm.m2cross(k=keyfld,f="sum_of_reoccurring_values",a="way,val",o=rlsDIR+"/rls30.csv")
f30.run()


#symmetry_looking
f31_0 =   nm.mcal(c="abs(${mean}-${median}),${max}-${min}",a="mean_median,max_min",i=sumDATA)
r_s=[0.0,0.05,0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55,0.6,0.65,0.7,0.75,0.8,0.85,0.9,0.95]
for r in r_s:
	f31 = nm.mcal(c="${mean_median}<${max_min}*%g"%(r),a="symmetry_looking_%g"%(r),i=f31_0)
	f31 <<= nm.m2cross(k=keyfld,f="symmetry_looking_%g"%(r),a="way,val",o=rlsDIR+"/rls31_%g.csv"%(r))
	f31.run()
	
#time_reversal_asymmetry_statistic
lag_s = [1,2,3] 
for lag in lag_s:
	f32 =   nm.mslide(i=baseDATA,k=keyfld,s=seqfld,f="val:valn",t=lag,l=True)
	f32 <<= nm.mslide(k=keyfld,s=seqfld,f="valn:valnn",t=lag,l=True)
	f32 <<= nm.mcal(c='${valnn}^2*${valn}-${val}^2*${valn}',a="time_reversal_asymmetry_statistic_lag_%g"%(lag))	
	f32 <<= nm.mavg(k=keyfld,f="time_reversal_asymmetry_statistic_lag_%g"%(lag))
	f32 <<= nm.m2cross(k=keyfld,f="time_reversal_asymmetry_statistic_lag_%g"%(lag),a="way,val",o=rlsDIR+"/rls32_%g.csv"%(lag))
	f32.run()	

#value_count
v_s = [0,1] 
for v in v_s:
	f33 = nm.mcal(c='${val}==%g'%(v),a="value_count_value_%g"%(v),i=baseDATA)
	f33 <<= nm.msum(k=keyfld,f="value_count_value_%g"%(v))
	f33 <<= nm.m2cross(k=keyfld,f="value_count_value_%g"%(v),a="way,val",o=rlsDIR+"/rls33_%g.csv"%(v))
	f33.run()


#value_count inf nan
v_s = [float("nan"),float("-inf"),float("inf")] 
head =keyfld[:]
for v in v_s:
	head.append("val_{}".format(v))

rlsf_10 = temo.file()
with mcsvout(rlsf_10,f=head) as rf10:

	for dlist in nm.readcsv(baseDATA).keyblock(keyfld,seqfld):

		rtn =  dlist[0][0:keySize]
		x= np.asarray([float(xdlist[keySize+1]) for xdlist in dlist])

		for v in v_s:
			if np.isnan(v):
				rtn.append(np.isnan(x).sum())
			else :
				rtn.append(x[x == v].size)

		rf10.write(rtn)
		
nm.m2cross(i=rlsf_10,k=keyfld,f="val_*",a="way,val",o=rlsDIR+"/rlsf_10.csv").run()


#variance_larger_than_standard_deviation
f34 =  nm.mcal(c='${var}>${sd}',a="variance_larger_than_standard_deviation",i=sumDATA)
f34 <<= nm.m2cross(k=keyfld,f="variance_larger_than_standard_deviation",a="way,val",o=rlsDIR+"/rlsf_34.csv")
f34.run()



fin  =  nm.mcat(i=rlsDIR+"/rls*.csv")
fin<<=  nm.mjoin(m=rlsDIR+"/idmap.csv",k="__keyID",f=orgid)
fin<<=  nm.mcut(f=orgid+["fldkey","way","val"])
fin<<=  nm.msortf(f=orgid+["fldkey","way"],o=outf)
fin.run()

